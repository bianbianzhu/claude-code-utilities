# Ralph æ“ä½œæ‰‹å†Œï¼ˆThe Ralph Playbookï¼‰

2025 å¹´ 12 æœˆï¼Œ[Ralph](https://ghuntley.com/ralph/) é‚£å¼ºå¤§å´çœ‹èµ·æ¥å‘†å‘†çš„å°è„¸è›‹è¢«æ¨ä¸Šäº†å¤§å¤šæ•° AI ç›¸å…³æ—¶é—´çº¿çš„é£å£æµªå°–ã€‚

æˆ‘ä¸€ç›´åœ¨å…³æ³¨ [@GeoffreyHuntley](https://x.com/GeoffreyHuntley) åˆ†äº«çš„é‚£äº›æå…¶èªæ˜çš„è§è§£ï¼Œä½†è¯´å®è¯ï¼Œä»Šå¹´å¤å¤© Ralph å¹¶æ²¡æœ‰çœŸæ­£è®©æˆ‘"å¼€çª"ã€‚è€Œæœ€è¿‘çš„è¿™æ³¢çƒ­è®®è®©äººå¾ˆéš¾å†å¿½è§†å®ƒäº†ã€‚

[@mattpocockuk](https://x.com/mattpocockuk/status/2008200878633931247) å’Œ [@ryancarson](https://x.com/ryancarson/status/2008548371712135632) çš„æ¦‚è¿°å¸®äº†å¤§å¿™â€”â€”ç›´åˆ° Geoff æœ¬äººè·³å‡ºæ¥[è¯´äº†å¥"ä¸å¯¹"](https://x.com/GeoffreyHuntley/status/2008731415312236984)ã€‚

<img src="references/nah.png" alt="nah" width="500" />

## é‚£ä¹ˆ Ralph çš„æœ€ä½³ç”¨æ³•åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

å¾ˆå¤šäººä¼¼ä¹ç”¨å„ç§å„æ ·çš„æ–¹å¼éƒ½å–å¾—äº†ä¸é”™çš„æ•ˆæœâ€”â€”ä½†æˆ‘æƒ³å°½å¯èƒ½ä»æºå¤´ä¸Šå»ç ”è¯»ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ–¹æ³•ä¸ä»…æ˜¯ç”±è¿™ä¸ªäººæå‡ºçš„ï¼Œè€Œä¸”ä»–ä¹Ÿæ˜¯å®è·µæ—¶é—´æœ€é•¿çš„é‚£ä¸ªäººã€‚

æ‰€ä»¥æˆ‘æ·±å…¥ç ”ç©¶äº†[æœ€è¿‘çš„è§†é¢‘](https://www.youtube.com/watch?v=O2bBWDoxO4s)å’Œ Geoff çš„[åŸå§‹æ–‡ç« ](https://ghuntley.com/ralph/)ï¼Œè¯•å›¾ä¸ºè‡ªå·±ç†æ¸…ä»€ä¹ˆæ–¹æ³•æ‰æ˜¯æœ€æœ‰æ•ˆçš„ã€‚

ä»¥ä¸‹å°±æ˜¯ç»“æœâ€”â€”ä¸€ä»½ï¼ˆå¯èƒ½æ˜¯å¼ºè¿«ç—‡é©±åŠ¨çš„ï¼‰Ralph æ“ä½œæ‰‹å†Œï¼Œå°†å„ç§é›¶æ•£çš„ç»†èŠ‚ç»„ç»‡èµ·æ¥ä»¥ä¾¿å®è·µï¼Œå¸Œæœ›ä¸ä¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­é˜‰å‰²å®ƒçš„ç²¾é«“ã€‚

> æ·±å…¥ç ”ç©¶è¿™äº›å†…å®¹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘è¿˜æƒ³åˆ°äº†ä¸€äº›å¯èƒ½æœ‰ä»·å€¼çš„[é¢å¤–å¢å¼ºæ–¹æ¡ˆ](#å¢å¼ºæ–¹æ¡ˆenhancements)ï¼Œæ—¨åœ¨ä¸ Ralph æˆåŠŸè¿ä½œçš„æ ¸å¿ƒå‡†åˆ™ä¿æŒä¸€è‡´ã€‚

> [!TIP] > [ğŸ“– æŸ¥çœ‹æ ¼å¼åŒ–æŒ‡å— â†’](https://ClaytonFarr.github.io/ralph-playbook/)

---

## ç›®å½•

- [å·¥ä½œæµç¨‹ï¼ˆWorkflowï¼‰](#å·¥ä½œæµç¨‹workflow)
- [æ ¸å¿ƒåŸåˆ™ï¼ˆKey Principlesï¼‰](#æ ¸å¿ƒåŸåˆ™key-principles)
- [å¾ªç¯æœºåˆ¶ï¼ˆLoop Mechanicsï¼‰](#å¾ªç¯æœºåˆ¶loop-mechanics)
- [æ–‡ä»¶ç»“æ„ï¼ˆFilesï¼‰](#æ–‡ä»¶ç»“æ„files)
- [å¢å¼ºæ–¹æ¡ˆï¼Ÿï¼ˆEnhancementsï¼‰](#å¢å¼ºæ–¹æ¡ˆenhancements)

---

## å·¥ä½œæµç¨‹ï¼ˆWorkflowï¼‰

ä¸€å¼ å›¾èƒœè¿‡åƒæ¡æ¨æ–‡å’Œä¸€ä¸ªå°æ—¶çš„è§†é¢‘ã€‚Geoff çš„[æ¦‚è¿°](https://ghuntley.com/ralph/)ï¼ˆæ³¨å†Œä»–çš„ newsletter å¯ä»¥çœ‹åˆ°å®Œæ•´æ–‡ç« ï¼‰ç¡®å®å¸®åŠ©æˆ‘ç†æ¸…äº†å·¥ä½œæµç¨‹çš„ç»†èŠ‚ï¼šä» 1) åˆ›æ„ â†’ 2) ä¸ JTBDï¼ˆå¾…å®Œæˆä»»åŠ¡ï¼‰å¯¹é½çš„ç‹¬ç«‹è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ â†’ 3) å…¨é¢çš„å®æ–½è®¡åˆ’ â†’ 4) Ralph å·¥ä½œå¾ªç¯ã€‚

![ralph-diagram.png](references/ralph-diagram.png)

### ğŸ—˜ ä¸‰ä¸ªé˜¶æ®µã€ä¸¤ä¸ªæç¤ºè¯ã€ä¸€ä¸ªå¾ªç¯

è¿™å¼ å›¾è®©æˆ‘æ˜ç™½äº† Ralph ä¸ä»…ä»…æ˜¯"ä¸€ä¸ªç¼–ç å¾ªç¯"ã€‚å®ƒæ˜¯ä¸€ä¸ªåŒ…å« 3 ä¸ªé˜¶æ®µï¼ˆPhaseï¼‰ã€2 ä¸ªæç¤ºè¯ï¼ˆPromptï¼‰å’Œ 1 ä¸ªå¾ªç¯ï¼ˆLoopï¼‰çš„æ¼æ–—ã€‚

#### é˜¶æ®µä¸€ï¼šå®šä¹‰éœ€æ±‚ï¼ˆPhase 1. Define Requirementsï¼‰ï¼ˆLLM å¯¹è¯ï¼‰

- è®¨è®ºé¡¹ç›®åˆ›æ„ â†’ è¯†åˆ«å¾…å®Œæˆä»»åŠ¡ï¼ˆJobs to Be Doneï¼ŒJTBDï¼‰
- å°†å•ä¸ª JTBD æ‹†åˆ†ä¸ºå…³æ³¨ä¸»é¢˜ï¼ˆTopic of Concernï¼‰
- ä½¿ç”¨å­ä»£ç†ï¼ˆsubagentï¼‰å°† URL ä¸­çš„ä¿¡æ¯åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­
- LLM ç†è§£ JTBD çš„å…³æ³¨ä¸»é¢˜åï¼šå­ä»£ç†ä¸ºæ¯ä¸ªä¸»é¢˜ç¼–å†™ `specs/FILENAME.md`

#### é˜¶æ®µäºŒ / ä¸‰ï¼šè¿è¡Œ Ralph å¾ªç¯ï¼ˆPhase 2 / 3. Run Ralph Loopï¼‰ï¼ˆä¸¤ç§æ¨¡å¼ï¼Œæ ¹æ®éœ€è¦åˆ‡æ¢ `PROMPT.md`ï¼‰

åŒæ ·çš„å¾ªç¯æœºåˆ¶ï¼Œä¸åŒçš„æç¤ºè¯å¯¹åº”ä¸åŒçš„ç›®æ ‡ï¼š

| æ¨¡å¼                   | ä½•æ—¶ä½¿ç”¨                      | æç¤ºè¯èšç„¦ç‚¹                         |
| ---------------------- | ----------------------------- | ------------------------------------ |
| _è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰_ | è®¡åˆ’ä¸å­˜åœ¨ï¼Œæˆ–è®¡åˆ’å·²è¿‡æ—¶/æœ‰è¯¯ | ä»…ç”Ÿæˆ/æ›´æ–° `IMPLEMENTATION_PLAN.md` |
| _æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰_ | è®¡åˆ’å·²å­˜åœ¨                    | æŒ‰è®¡åˆ’å®æ–½ã€æäº¤ã€é™„å¸¦æ›´æ–°è®¡åˆ’       |

_å„æ¨¡å¼çš„æç¤ºè¯å·®å¼‚ï¼š_

- "è§„åˆ’"æç¤ºè¯æ‰§è¡Œå·®è·åˆ†æï¼ˆGap Analysisï¼‰ï¼ˆè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ vs ä»£ç ï¼‰ï¼Œè¾“å‡ºä¼˜å…ˆçº§æ’åºçš„å¾…åŠåˆ—è¡¨â€”â€”ä¸å®æ–½ã€ä¸æäº¤ã€‚
- "æ„å»º"æç¤ºè¯å‡è®¾è®¡åˆ’å·²å­˜åœ¨ï¼Œä»ä¸­é€‰å–ä»»åŠ¡ï¼Œå®æ–½ï¼Œè¿è¡Œæµ‹è¯•ï¼ˆåå‹ï¼Œbackpressureï¼‰ï¼Œæäº¤ã€‚

_ä¸ºä»€ä¹ˆä¸¤ç§æ¨¡å¼éƒ½ä½¿ç”¨å¾ªç¯ï¼Ÿ_

- æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰æœ¬èº«å°±éœ€è¦å¾ªç¯ï¼šæœ¬è´¨ä¸Šæ˜¯è¿­ä»£çš„ï¼ˆå¤šä»»åŠ¡ Ã— å…¨æ–°ä¸Šä¸‹æ–‡ = éš”ç¦»ï¼‰
- è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰ä½¿ç”¨å¾ªç¯æ˜¯ä¸ºäº†ä¸€è‡´æ€§ï¼šç›¸åŒçš„æ‰§è¡Œæ¨¡å‹ï¼Œè™½ç„¶é€šå¸¸ 1-2 æ¬¡è¿­ä»£å°±å®Œæˆ
- çµæ´»æ€§ï¼šå¦‚æœè®¡åˆ’éœ€è¦ä¼˜åŒ–ï¼Œå¾ªç¯å…è®¸å¤šæ¬¡è¯»å–è‡ªèº«è¾“å‡º
- ç®€æ´æ€§ï¼šä¸€ç§æœºåˆ¶å¤„ç†æ‰€æœ‰äº‹æƒ…ï¼›å¹²å‡€çš„æ–‡ä»¶ I/Oï¼›æ˜“äºåœæ­¢/é‡å¯

_æ¯æ¬¡è¿­ä»£åŠ è½½çš„ä¸Šä¸‹æ–‡ï¼š_ `PROMPT.md` + `AGENTS.md`

_è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰å¾ªç¯ç”Ÿå‘½å‘¨æœŸï¼š_

1. å­ä»£ç†ç ”è¯» `specs/*` å’Œç°æœ‰çš„ `/src`
2. å°†è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ä¸ä»£ç è¿›è¡Œæ¯”è¾ƒï¼ˆå·®è·åˆ†æï¼‰
3. åˆ›å»º/æ›´æ–° `IMPLEMENTATION_PLAN.md`ï¼ŒåŒ…å«ä¼˜å…ˆçº§æ’åºçš„ä»»åŠ¡
4. ä¸è¿›è¡Œä»»ä½•å®æ–½

_æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰å¾ªç¯ç”Ÿå‘½å‘¨æœŸï¼š_

1. _å®šå‘_ â€“ å­ä»£ç†ç ”è¯» `specs/*`ï¼ˆéœ€æ±‚ï¼‰
2. _é˜…è¯»è®¡åˆ’_ â€“ ç ”è¯» `IMPLEMENTATION_PLAN.md`
3. _é€‰æ‹©_ â€“ æŒ‘é€‰æœ€é‡è¦çš„ä»»åŠ¡
4. _è°ƒæŸ¥_ â€“ å­ä»£ç†ç ”è¯»ç›¸å…³çš„ `/src`ï¼ˆ"ä¸è¦å‡è®¾æœªå®ç°"ï¼‰
5. _å®æ–½_ â€“ N ä¸ªå­ä»£ç†ç”¨äºæ–‡ä»¶æ“ä½œ
6. _éªŒè¯_ â€“ 1 ä¸ªå­ä»£ç†ç”¨äºæ„å»º/æµ‹è¯•ï¼ˆåå‹ï¼‰
7. _æ›´æ–° `IMPLEMENTATION_PLAN.md`_ â€“ æ ‡è®°ä»»åŠ¡å®Œæˆï¼Œè®°å½•å‘ç°/ç¼ºé™·
8. _æ›´æ–° `AGENTS.md`_ â€“ å¦‚æœæœ‰æ“ä½œå±‚é¢çš„ç»éªŒæ•™è®­
9. _æäº¤_
10. _å¾ªç¯ç»“æŸ_ â†’ ä¸Šä¸‹æ–‡æ¸…é™¤ â†’ ä¸‹ä¸€æ¬¡è¿­ä»£å…¨æ–°å¼€å§‹

#### æ¦‚å¿µ

| æœ¯è¯­                                 | å®šä¹‰                                              |
| ------------------------------------ | ------------------------------------------------- |
| _å¾…å®Œæˆä»»åŠ¡ï¼ˆJob to be Doneï¼ŒJTBDï¼‰_ | é«˜å±‚æ¬¡çš„ç”¨æˆ·éœ€æ±‚æˆ–æœŸæœ›ç»“æœ                        |
| _å…³æ³¨ä¸»é¢˜ï¼ˆTopic of Concernï¼‰_       | JTBD ä¸­ä¸€ä¸ªç‹¬ç«‹çš„æ–¹é¢/ç»„ä»¶                        |
| _è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰_                   | é’ˆå¯¹ä¸€ä¸ªå…³æ³¨ä¸»é¢˜çš„éœ€æ±‚æ–‡æ¡£ï¼ˆ`specs/FILENAME.md`ï¼‰ |
| _ä»»åŠ¡ï¼ˆTaskï¼‰_                       | é€šè¿‡æ¯”è¾ƒè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ä¸ä»£ç å¾—å‡ºçš„å·¥ä½œå•å…ƒ              |

_å…³ç³»ï¼š_

- 1 ä¸ª JTBD â†’ å¤šä¸ªå…³æ³¨ä¸»é¢˜
- 1 ä¸ªå…³æ³¨ä¸»é¢˜ â†’ 1 ä»½è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰
- 1 ä»½è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ â†’ å¤šä¸ªä»»åŠ¡ï¼ˆè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰çš„ç²’åº¦å¤§äºä»»åŠ¡ï¼‰

_ç¤ºä¾‹ï¼š_

- JTBDï¼š"å¸®åŠ©è®¾è®¡å¸ˆåˆ›å»ºæƒ…ç»ªæ¿"
- å…³æ³¨ä¸»é¢˜ï¼šå›¾ç‰‡æ”¶é›†ã€é¢œè‰²æå–ã€å¸ƒå±€ã€åˆ†äº«
- æ¯ä¸ªä¸»é¢˜ â†’ ä¸€ä¸ª spec æ–‡ä»¶
- æ¯ä¸ª spec â†’ å®æ–½è®¡åˆ’ä¸­çš„å¤šä¸ªä»»åŠ¡

_ä¸»é¢˜èŒƒå›´æµ‹è¯•ï¼š"ä¸€å¥è¯ä¸å¸¦'å’Œ'"_

- ä½ èƒ½å¦ç”¨ä¸€å¥è¯ï¼ˆä¸ä½¿ç”¨"å’Œ"è¿æ¥ä¸ç›¸å…³çš„åŠŸèƒ½ï¼‰æ¥æè¿°è¿™ä¸ªå…³æ³¨ä¸»é¢˜ï¼Ÿ
  - âœ“ "é¢œè‰²æå–ç³»ç»Ÿåˆ†æå›¾åƒä»¥è¯†åˆ«ä¸»è‰²è°ƒ"
  - âœ— "ç”¨æˆ·ç³»ç»Ÿå¤„ç†è®¤è¯ã€ç”¨æˆ·èµ„æ–™å’Œè®¡è´¹" â†’ è¿™æ˜¯ 3 ä¸ªä¸»é¢˜
- å¦‚æœä½ éœ€è¦ç”¨"å’Œ"æ¥æè¿°å®ƒåšä»€ä¹ˆï¼Œé‚£å®ƒå¯èƒ½æ˜¯å¤šä¸ªä¸»é¢˜

---

## æ ¸å¿ƒåŸåˆ™ï¼ˆKey Principlesï¼‰

### â³ ä¸Šä¸‹æ–‡å°±æ˜¯*ä¸€åˆ‡*

- å½“å®£ç§°çš„ 200K+ token = å®é™…å¯ç”¨çº¦ 176K
- ä¸” 40-60% çš„ä¸Šä¸‹æ–‡åˆ©ç”¨ç‡ä¸º"æ™ºèƒ½åŒºé—´ï¼ˆsmart zoneï¼‰"
- ç²¾ç®€ä»»åŠ¡ + æ¯æ¬¡å¾ªç¯ 1 ä¸ªä»»åŠ¡ = _100% æ™ºèƒ½åŒºé—´ä¸Šä¸‹æ–‡åˆ©ç”¨ç‡_

è¿™ä¸ªåŸåˆ™é©±åŠ¨å’Œå½±å“ç€å…¶ä»–æ‰€æœ‰è®¾è®¡ï¼š

- _å°†ä¸»ä»£ç†/ä¸Šä¸‹æ–‡ç”¨ä½œè°ƒåº¦å™¨ï¼ˆschedulerï¼‰_
  - ä¸è¦å°†é«˜å¼€é”€çš„å·¥ä½œåˆ†é…ç»™ä¸»ä¸Šä¸‹æ–‡ï¼›å°½å¯èƒ½ç”Ÿæˆå­ä»£ç†æ¥å¤„ç†
- _å°†å­ä»£ç†ç”¨ä½œå†…å­˜æ‰©å±•_
  - æ¯ä¸ªå­ä»£ç†è·å¾—çº¦ 156kbï¼Œç”¨å®Œå³å›æ”¶ï¼ˆgarbage collectedï¼‰
  - åˆ†æ•£å¤„ç†ä»¥é¿å…æ±¡æŸ“ä¸»ä¸Šä¸‹æ–‡
- _ç®€æ´è‡³ä¸Š_
  - é€‚ç”¨äºç³»ç»Ÿçš„éƒ¨ä»¶æ•°é‡ã€å¾ªç¯é…ç½®å’Œå†…å®¹
  - å†—é•¿çš„è¾“å…¥ä¼šé™ä½ç¡®å®šæ€§ï¼ˆdeterminismï¼‰
- _ä¼˜å…ˆä½¿ç”¨ Markdown è€Œé JSON_
  - ç”¨äºå®šä¹‰å’Œè·Ÿè¸ªå·¥ä½œï¼Œä»¥è·å¾—æ›´å¥½çš„ token æ•ˆç‡

### ğŸ§­ å¼•å¯¼ Ralphï¼šæ¨¡å¼ + åå‹ï¼ˆPatterns + Backpressureï¼‰

åˆ›å»ºæ­£ç¡®çš„ä¿¡å·å’Œé—¨æ§æ¥å¼•å¯¼ Ralph æˆåŠŸè¾“å‡ºæ˜¯**è‡³å…³é‡è¦çš„**ã€‚ä½ å¯ä»¥ä»ä¸¤ä¸ªæ–¹å‘è¿›è¡Œå¼•å¯¼ï¼š

- _ä¸Šæ¸¸å¼•å¯¼ï¼ˆSteer upstreamï¼‰_
  - ç¡®ä¿ç¡®å®šæ€§çš„è®¾ç½®ï¼š
    - å°†å‰çº¦ 5,000 ä¸ª token åˆ†é…ç»™è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰
    - æ¯æ¬¡å¾ªç¯çš„ä¸Šä¸‹æ–‡éƒ½åŠ è½½ç›¸åŒçš„æ–‡ä»¶ï¼Œä½¿æ¨¡å‹ä»å·²çŸ¥çŠ¶æ€å¼€å§‹ï¼ˆ`PROMPT.md` + `AGENTS.md`ï¼‰
  - ä½ ç°æœ‰çš„ä»£ç ä¼šå½±å“ç”Ÿæˆå’Œä½¿ç”¨çš„å†…å®¹
  - å¦‚æœ Ralph ç”Ÿæˆäº†é”™è¯¯çš„æ¨¡å¼ï¼Œæ·»åŠ /æ›´æ–°å·¥å…·å‡½æ•°å’Œç°æœ‰ä»£ç æ¨¡å¼æ¥å¼•å¯¼å®ƒèµ°å‘æ­£ç¡®çš„æ–¹å‘
- _ä¸‹æ¸¸å¼•å¯¼ï¼ˆSteer downstreamï¼‰_
  - é€šè¿‡æµ‹è¯•ã€ç±»å‹æ£€æŸ¥ã€ä»£ç æ£€æŸ¥ï¼ˆlintï¼‰ã€æ„å»ºç­‰åˆ›å»ºåå‹ï¼ˆbackpressureï¼‰ï¼Œç”¨ä»¥æ‹’ç»æ— æ•ˆ/ä¸å¯æ¥å—çš„å·¥ä½œ
  - æç¤ºè¯ä¸­æ³›æ³›åœ°è¯´"è¿è¡Œæµ‹è¯•"ã€‚`AGENTS.md` æŒ‡å®šå®é™…å‘½ä»¤ä»¥ä½¿åå‹å…·æœ‰é¡¹ç›®ç‰¹å®šæ€§
  - åå‹å¯ä»¥è¶…è¶Šä»£ç éªŒè¯çš„èŒƒç•´ï¼šæŸäº›éªŒæ”¶æ ‡å‡†æ— æ³•é€šè¿‡ç¨‹åºåŒ–æ£€æŸ¥æ¥éªŒè¯â€”â€”åˆ›æ„è´¨é‡ã€ç¾å­¦ã€ç”¨æˆ·ä½“éªŒæ„Ÿå—ã€‚LLM ä½œä¸ºè¯„å®¡ï¼ˆLLM-as-judgeï¼‰æµ‹è¯•å¯ä»¥ä¸ºä¸»è§‚æ ‡å‡†æä¾›å…·æœ‰äºŒå…ƒé€šè¿‡/å¤±è´¥ç»“æœçš„åå‹ã€‚ï¼ˆ[ä¸‹é¢æœ‰æ›´è¯¦ç»†çš„æ€è€ƒ](#éç¡®å®šæ€§åå‹non-deterministic-backpressure)å…³äºå¦‚ä½•åœ¨ Ralph ä¸­å®ç°è¿™ä¸€ç‚¹ã€‚ï¼‰
- _æé†’ Ralph åˆ›å»º/ä½¿ç”¨åå‹_
  - åœ¨å®æ–½æ—¶æé†’ Ralph ä½¿ç”¨åå‹ï¼š"é‡è¦ï¼šåœ¨ç¼–å†™æ–‡æ¡£æ—¶ï¼Œè®°å½•åŸå› ï¼ˆwhyï¼‰â€”â€”æµ‹è¯•å’Œå®æ–½çš„é‡è¦æ€§ã€‚"

### ğŸ™ è®© Ralph åš Ralphï¼ˆLet Ralph Ralphï¼‰

Ralph çš„æœ‰æ•ˆæ€§æ¥è‡ªäºä½ å¯¹å®ƒçš„ä¿¡ä»»ç¨‹åº¦â€”â€”ä¿¡ä»»å®ƒæœ€ç»ˆä¼šåšå¯¹äº‹æƒ…â€”â€”ä»¥åŠä½ ä¿ƒè¿›å…¶èƒ½åŠ›çš„æ–¹å¼ã€‚

- _è®© Ralph åš Ralph_
  - å……åˆ†åˆ©ç”¨ LLM çš„è‡ªæˆ‘è¯†åˆ«ã€è‡ªæˆ‘çº æ­£å’Œè‡ªæˆ‘æ”¹è¿›èƒ½åŠ›
  - é€‚ç”¨äºå®æ–½è®¡åˆ’ã€ä»»åŠ¡å®šä¹‰å’Œä¼˜å…ˆçº§æ’åº
  - é€šè¿‡è¿­ä»£å®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼ˆeventual consistencyï¼‰
- _åšå¥½é˜²æŠ¤_
  - ä¸ºäº†è‡ªä¸»è¿è¡Œï¼ŒRalph éœ€è¦ `--dangerously-skip-permissions`â€”â€”åœ¨æ¯æ¬¡å·¥å…·è°ƒç”¨æ—¶è¯·æ±‚æ‰¹å‡†ä¼šæ‰“æ–­å¾ªç¯ã€‚è¿™å®Œå…¨ç»•è¿‡äº† Claude çš„æƒé™ç³»ç»Ÿâ€”â€”å› æ­¤æ²™ç®±ï¼ˆsandboxï¼‰æˆä¸ºä½ å”¯ä¸€çš„å®‰å…¨è¾¹ç•Œã€‚
  - ç†å¿µï¼š"ä¸æ˜¯ä¼šä¸ä¼šè¢«æ”»ç ´çš„é—®é¢˜ï¼Œè€Œæ˜¯ä»€ä¹ˆæ—¶å€™è¢«æ”»ç ´ã€‚ä»¥åŠçˆ†ç‚¸åŠå¾„æœ‰å¤šå¤§ï¼Ÿ"
  - ä¸ä½¿ç”¨æ²™ç®±è¿è¡Œä¼šæš´éœ²ä½ æœºå™¨ä¸Šçš„å‡­è¯ã€æµè§ˆå™¨ cookieã€SSH å¯†é’¥å’Œè®¿é—®ä»¤ç‰Œ
  - åœ¨éš”ç¦»ç¯å¢ƒä¸­è¿è¡Œï¼Œä»…æä¾›æœ€å°å¯è¡Œçš„è®¿é—®æƒé™ï¼š
    - ä»…éœ€ä»»åŠ¡æ‰€éœ€çš„ API å¯†é’¥å’Œéƒ¨ç½²å¯†é’¥
    - ä¸è®¿é—®éœ€æ±‚ä»¥å¤–çš„ç§æœ‰æ•°æ®
    - å°½å¯èƒ½é™åˆ¶ç½‘ç»œè¿æ¥
  - é€‰é¡¹ï¼šDocker æ²™ç®±ï¼ˆæœ¬åœ°ï¼‰ï¼ŒFly Sprites/E2B ç­‰ï¼ˆè¿œç¨‹/ç”Ÿäº§ï¼‰- [é™„åŠ è¯´æ˜](references/sandbox-environments.md)
  - é¢å¤–çš„é€ƒç”Ÿé€šé“ï¼šCtrl+C åœæ­¢å¾ªç¯ï¼›`git reset --hard` å›æ»šæœªæäº¤çš„æ›´æ”¹ï¼›å¦‚æœè½¨è¿¹åç¦»åˆ™é‡æ–°ç”Ÿæˆè®¡åˆ’

### ğŸš¦ ç«™åœ¨å¾ªç¯å¤–é¢ï¼ˆMove Outside the Loopï¼‰

è¦æœ€å¤§åŒ–å‘æŒ¥ Ralph çš„ä»·å€¼ï¼Œä½ éœ€è¦è®©å¼€ä»–çš„è·¯ã€‚Ralph åº”è¯¥å®Œæˆ*æ‰€æœ‰*å·¥ä½œï¼ŒåŒ…æ‹¬å†³å®šæ¥ä¸‹æ¥å®æ–½å“ªé¡¹è®¡åˆ’å·¥ä½œä»¥åŠå¦‚ä½•å®æ–½ã€‚ä½ çš„å·¥ä½œç°åœ¨æ˜¯ååœ¨å¾ªç¯ä¸Šé¢è€Œä¸æ˜¯é‡Œé¢â€”â€”å»è®¾è®¡èƒ½è®© Ralph æˆåŠŸçš„é…ç½®å’Œç¯å¢ƒã€‚

_è§‚å¯Ÿä¸çº å_ â€“ å°¤å…¶æ˜¯åœ¨æ—©æœŸï¼Œåä¸‹æ¥è§‚å¯Ÿã€‚å‡ºç°äº†ä»€ä¹ˆæ¨¡å¼ï¼ŸRalph åœ¨å“ªé‡Œå‡ºé”™ï¼Ÿå®ƒéœ€è¦ä»€ä¹ˆä¿¡å·ï¼Ÿä½ å¼€å§‹æ—¶çš„æç¤ºè¯ä¸ä¼šæ˜¯ä½ æœ€ç»ˆçš„æç¤ºè¯â€”â€”å®ƒä»¬é€šè¿‡è§‚å¯Ÿåˆ°çš„å¤±è´¥æ¨¡å¼æ¥æ¼”åŒ–ã€‚

_åƒè°ƒå‰ä»–ä¸€æ ·è°ƒä¼˜_ â€“ ä¸è¦ä¸€å¼€å§‹å°±è§„å®šæ‰€æœ‰ä¸œè¥¿ï¼Œè€Œæ˜¯è§‚å¯Ÿå¹¶è¢«åŠ¨è°ƒæ•´ã€‚å½“ Ralph ä»¥æŸç§ç‰¹å®šæ–¹å¼å¤±è´¥æ—¶ï¼Œæ·»åŠ ä¸€ä¸ªä¿¡å·æ¥å¸®åŠ©å®ƒä¸‹æ¬¡åšå¯¹ã€‚

ä½†ä¿¡å·ä¸ä»…ä»…æ˜¯æç¤ºè¯æ–‡æœ¬ã€‚å®ƒæ˜¯ Ralph å¯ä»¥å‘ç°çš„*ä»»ä½•ä¸œè¥¿*ï¼š

- æç¤ºè¯æŠ¤æ  - æ˜ç¡®çš„æŒ‡ç¤ºï¼Œå¦‚"ä¸è¦å‡è®¾æœªå®ç°"
- `AGENTS.md` - å…³äºå¦‚ä½•æ„å»º/æµ‹è¯•çš„æ“ä½œæ€§ç»éªŒ
- ä½ ä»£ç åº“ä¸­çš„å·¥å…·å‡½æ•° - å½“ä½ æ·»åŠ ä¸€ä¸ªæ¨¡å¼æ—¶ï¼ŒRalph ä¼šå‘ç°å¹¶éµå¾ªå®ƒ
- å…¶ä»–å¯å‘ç°çš„ç›¸å…³è¾“å…¥â€¦â€¦

è®°ä½ï¼Œ_è®¡åˆ’æ˜¯å¯ä¸¢å¼ƒçš„ï¼š_

- å¦‚æœå®ƒæ˜¯é”™çš„ï¼Œæ‰”æ‰é‡æ¥
- é‡æ–°ç”Ÿæˆçš„æˆæœ¬åªæ˜¯ä¸€æ¬¡è§„åˆ’å¾ªç¯ï¼›æ¯” Ralph åŸåœ°æ‰“è½¬ä¾¿å®œå¾—å¤š
- åœ¨ä»¥ä¸‹æƒ…å†µä¸‹é‡æ–°ç”Ÿæˆï¼š
  - Ralph è·‘åäº†ï¼ˆå®æ–½äº†é”™è¯¯çš„ä¸œè¥¿ï¼Œé‡å¤å·¥ä½œï¼‰
  - è®¡åˆ’æ„Ÿè§‰è¿‡æ—¶æˆ–ä¸å½“å‰çŠ¶æ€ä¸ç¬¦
  - å·²å®Œæˆçš„é¡¹ç›®è¿‡å¤šå¯¼è‡´æ‚ä¹±
  - ä½ åšäº†é‡å¤§çš„è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰å˜æ›´
  - ä½ æä¸æ¸…æ¥šä»€ä¹ˆå®é™…ä¸Šå·²ç»å®Œæˆäº†

---

## å¾ªç¯æœºåˆ¶ï¼ˆLoop Mechanicsï¼‰

### å¤–å¾ªç¯æ§åˆ¶ï¼ˆOuter Loop Controlï¼‰

Geoff çš„ `loop.sh` è„šæœ¬åˆå§‹æœ€ç®€å½¢å¼ï¼š

```bash
while :; do cat PROMPT.md | claude ; done
```

_æ³¨æ„ï¼š_ åŒæ ·çš„æ–¹å¼å¯ä»¥ç”¨äºå…¶ä»– CLI å·¥å…·ï¼›ä¾‹å¦‚ `amp`ã€`codex`ã€`opencode` ç­‰ã€‚

_ä»€ä¹ˆæ§åˆ¶ä»»åŠ¡çš„å»¶ç»­ï¼Ÿ_

å»¶ç»­æœºåˆ¶éå¸¸ä¼˜é›…ç®€æ´ï¼š

1. _Bash å¾ªç¯è¿è¡Œ_ â†’ å°† `PROMPT.md` è¾“å…¥ç»™ claude
2. _PROMPT.md æŒ‡ç¤º_ â†’ "ç ”è¯» IMPLEMENTATION_PLAN.md å¹¶é€‰æ‹©æœ€é‡è¦çš„äº‹é¡¹"
3. _ä»£ç†å®Œæˆä¸€ä¸ªä»»åŠ¡_ â†’ æ›´æ–°ç£ç›˜ä¸Šçš„ IMPLEMENTATION_PLAN.mdï¼Œæäº¤ï¼Œé€€å‡º
4. _Bash å¾ªç¯ç«‹å³é‡å¯_ â†’ å…¨æ–°çš„ä¸Šä¸‹æ–‡çª—å£
5. _ä»£ç†è¯»å–æ›´æ–°åçš„è®¡åˆ’_ â†’ é€‰æ‹©ä¸‹ä¸€ä¸ªæœ€é‡è¦çš„äº‹é¡¹

_å…³é”®æ´å¯Ÿï¼š_ IMPLEMENTATION_PLAN.md æ–‡ä»¶åœ¨è¿­ä»£ä¹‹é—´æŒä¹…åŒ–åœ¨ç£ç›˜ä¸Šï¼Œå……å½“åŸæœ¬éš”ç¦»çš„å¾ªç¯æ‰§è¡Œä¹‹é—´çš„å…±äº«çŠ¶æ€ã€‚æ¯æ¬¡è¿­ä»£ç¡®å®šæ€§åœ°åŠ è½½ç›¸åŒçš„æ–‡ä»¶ï¼ˆ`PROMPT.md` + `AGENTS.md` + `specs/*`ï¼‰å¹¶ä»ç£ç›˜è¯»å–å½“å‰çŠ¶æ€ã€‚

_ä¸éœ€è¦å¤æ‚çš„ç¼–æ’_ - åªéœ€è¦ä¸€ä¸ªæ„šè ¢çš„ bash å¾ªç¯ä¸æ–­é‡å¯ä»£ç†ï¼Œä»£ç†é€šè¿‡æ¯æ¬¡è¯»å–è®¡åˆ’æ–‡ä»¶æ¥å¼„æ¸…æ¥šæ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆã€‚

### å†…å¾ªç¯æ§åˆ¶ï¼ˆInner Loop Controlï¼‰ï¼ˆä»»åŠ¡æ‰§è¡Œï¼‰

å•ä¸ªä»»åŠ¡æ‰§è¡Œæ²¡æœ‰ç¡¬æ€§çš„æŠ€æœ¯é™åˆ¶ã€‚æ§åˆ¶ä¾èµ–äºï¼š

- _èŒƒå›´çºªå¾‹_ - PROMPT.md æŒ‡ç¤º"ä¸€ä¸ªä»»åŠ¡"å’Œ"æµ‹è¯•é€šè¿‡åæäº¤"
- _åå‹_ - æµ‹è¯•/æ„å»ºå¤±è´¥è¿«ä½¿ä»£ç†åœ¨æäº¤å‰ä¿®å¤é—®é¢˜
- _è‡ªç„¶å®Œæˆ_ - ä»£ç†åœ¨æˆåŠŸæäº¤åé€€å‡º

_Ralph å¯èƒ½ä¼šåŸåœ°æ‰“è½¬ã€å¿½ç•¥æŒ‡ç¤ºæˆ–èµ°é”™æ–¹å‘_ - è¿™æ˜¯é¢„æœŸä¸­çš„ï¼Œæ˜¯è°ƒä¼˜è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚å½“ Ralph ä»¥ç‰¹å®šæ–¹å¼"è€ƒéªŒä½ "æ—¶ï¼Œä½ åœ¨æç¤ºè¯ä¸­æ·»åŠ æŠ¤æ æˆ–è°ƒæ•´åå‹æœºåˆ¶ã€‚éç¡®å®šæ€§é€šè¿‡è§‚å¯Ÿå’Œè¿­ä»£æ˜¯å¯ç®¡ç†çš„ã€‚

### å¢å¼ºç‰ˆå¾ªç¯ç¤ºä¾‹

åœ¨æ ¸å¿ƒå¾ªç¯åŸºç¡€ä¸Šå°è£…äº†æ¨¡å¼é€‰æ‹©ï¼ˆè§„åˆ’/æ„å»ºï¼‰ã€æœ€å¤§è¿­ä»£æ¬¡æ•°æ”¯æŒå’Œæ¯æ¬¡è¿­ä»£åçš„ git pushã€‚

_æ­¤å¢å¼ºç‰ˆä½¿ç”¨ä¸¤ä¸ªä¿å­˜çš„æç¤ºè¯æ–‡ä»¶ï¼š_

- `PROMPT_plan.md` - è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰ï¼ˆå·®è·åˆ†æï¼Œç”Ÿæˆ/æ›´æ–°è®¡åˆ’ï¼‰
- `PROMPT_build.md` - æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰ï¼ˆæŒ‰è®¡åˆ’å®æ–½ï¼‰

```bash
#!/bin/bash
# Usage: ./loop.sh [plan] [max_iterations]
# Examples:
#   ./loop.sh              # Build mode, unlimited iterations
#   ./loop.sh 20           # Build mode, max 20 iterations
#   ./loop.sh plan         # Plan mode, unlimited iterations
#   ./loop.sh plan 5       # Plan mode, max 5 iterations

# Parse arguments
if [ "$1" = "plan" ]; then
    # Plan mode
    MODE="plan"
    PROMPT_FILE="PROMPT_plan.md"
    MAX_ITERATIONS=${2:-0}
elif [[ "$1" =~ ^[0-9]+$ ]]; then
    # Build mode with max iterations
    MODE="build"
    PROMPT_FILE="PROMPT_build.md"
    MAX_ITERATIONS=$1
else
    # Build mode, unlimited (no arguments or invalid input)
    MODE="build"
    PROMPT_FILE="PROMPT_build.md"
    MAX_ITERATIONS=0
fi

ITERATION=0
CURRENT_BRANCH=$(git branch --show-current)

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Mode:   $MODE"
echo "Prompt: $PROMPT_FILE"
echo "Branch: $CURRENT_BRANCH"
[ $MAX_ITERATIONS -gt 0 ] && echo "Max:    $MAX_ITERATIONS iterations"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Verify prompt file exists
if [ ! -f "$PROMPT_FILE" ]; then
    echo "Error: $PROMPT_FILE not found"
    exit 1
fi

while true; do
    if [ $MAX_ITERATIONS -gt 0 ] && [ $ITERATION -ge $MAX_ITERATIONS ]; then
        echo "Reached max iterations: $MAX_ITERATIONS"
        break
    fi

    # Run Ralph iteration with selected prompt
    # -p: Headless mode (non-interactive, reads from stdin)
    # --dangerously-skip-permissions: Auto-approve all tool calls (YOLO mode)
    # --output-format=stream-json: Structured output for logging/monitoring
    # --model opus: Primary agent uses Opus for complex reasoning (task selection, prioritization)
    #               Can use 'sonnet' in build mode for speed if plan is clear and tasks well-defined
    # --verbose: Detailed execution logging
    cat "$PROMPT_FILE" | claude -p \
        --dangerously-skip-permissions \
        --output-format=stream-json \
        --model opus \
        --verbose

    # Push changes after each iteration
    git push origin "$CURRENT_BRANCH" || {
        echo "Failed to push. Creating remote branch..."
        git push -u origin "$CURRENT_BRANCH"
    }

    ITERATION=$((ITERATION + 1))
    echo -e "\n\n======================== LOOP $ITERATION ========================\n"
done
```

_æ¨¡å¼é€‰æ‹©ï¼š_

- æ— å…³é”®å­— â†’ ä½¿ç”¨ `PROMPT_build.md` è¿›è¡Œæ„å»ºï¼ˆå®æ–½ï¼‰
- `plan` å…³é”®å­— â†’ ä½¿ç”¨ `PROMPT_plan.md` è¿›è¡Œè§„åˆ’ï¼ˆå·®è·åˆ†æã€è®¡åˆ’ç”Ÿæˆï¼‰

_æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼š_

- é™åˆ¶çš„æ˜¯*å¤–å¾ªç¯*ï¼ˆå°è¯•çš„ä»»åŠ¡æ•°é‡ï¼›ä¸æ˜¯å•ä¸ªä»»åŠ¡ä¸­çš„å·¥å…·è°ƒç”¨æ¬¡æ•°ï¼‰
- æ¯æ¬¡è¿­ä»£ = ä¸€ä¸ªå…¨æ–°çš„ä¸Šä¸‹æ–‡çª—å£ = IMPLEMENTATION_PLAN.md ä¸­çš„ä¸€ä¸ªä»»åŠ¡ = ä¸€æ¬¡æäº¤
- `./loop.sh` æ— é™è¿è¡Œï¼ˆæ‰‹åŠ¨ç”¨ Ctrl+C åœæ­¢ï¼‰
- `./loop.sh 20` æœ€å¤šè¿è¡Œ 20 æ¬¡è¿­ä»£ååœæ­¢

_Claude CLI å‚æ•°ï¼š_

- `-p`ï¼ˆæ— å¤´æ¨¡å¼ï¼Œheadless modeï¼‰ï¼šå¯ç”¨éäº¤äº’æ“ä½œï¼Œä»æ ‡å‡†è¾“å…¥è¯»å–æç¤ºè¯
- `--dangerously-skip-permissions`ï¼šè·³è¿‡æ‰€æœ‰æƒé™æç¤ºï¼Œå®ç°å…¨è‡ªåŠ¨è¿è¡Œ
- `--output-format=stream-json`ï¼šè¾“å‡ºç»“æ„åŒ– JSON ç”¨äºæ—¥å¿—/ç›‘æ§/å¯è§†åŒ–
- `--model opus`ï¼šä¸»ä»£ç†ä½¿ç”¨ Opus è¿›è¡Œä»»åŠ¡é€‰æ‹©ã€ä¼˜å…ˆçº§æ’åºå’Œåè°ƒï¼ˆå¦‚æœä»»åŠ¡æ˜ç¡®å¯ä»¥ä½¿ç”¨ `sonnet` ä»¥æé«˜é€Ÿåº¦ï¼‰
- `--verbose`ï¼šæä¾›è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—

---

## æ–‡ä»¶ç»“æ„ï¼ˆFilesï¼‰

```
project-root/
â”œâ”€â”€ loop.sh                         # Ralph å¾ªç¯è„šæœ¬
â”œâ”€â”€ PROMPT_build.md                 # æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰æŒ‡ä»¤
â”œâ”€â”€ PROMPT_plan.md                  # è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰æŒ‡ä»¤
â”œâ”€â”€ AGENTS.md                       # æ¯æ¬¡è¿­ä»£åŠ è½½çš„æ“ä½œæŒ‡å—
â”œâ”€â”€ IMPLEMENTATION_PLAN.md          # ä¼˜å…ˆçº§æ’åºçš„ä»»åŠ¡åˆ—è¡¨ï¼ˆç”± Ralph ç”Ÿæˆ/æ›´æ–°ï¼‰
â”œâ”€â”€ specs/                          # éœ€æ±‚è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ï¼ˆæ¯ä¸ª JTBD ä¸»é¢˜ä¸€ä»½ï¼‰
â”‚   â”œâ”€â”€ [jtbd-topic-a].md
â”‚   â””â”€â”€ [jtbd-topic-b].md
â”œâ”€â”€ src/                            # åº”ç”¨æºä»£ç 
â””â”€â”€ src/lib/                        # å…±äº«å·¥å…·å‡½æ•°å’Œç»„ä»¶
```

### `loop.sh`

ç¼–æ’ Ralph è¿­ä»£çš„å¤–å¾ªç¯è„šæœ¬ã€‚

è¯¦ç»†çš„å®ç°ç¤ºä¾‹å’Œé…ç½®é€‰é¡¹è¯·å‚è§[å¾ªç¯æœºåˆ¶](#å¾ªç¯æœºåˆ¶loop-mechanics)ç« èŠ‚ã€‚

_è®¾ç½®ï¼š_ é¦–æ¬¡ä½¿ç”¨å‰ä½¿è„šæœ¬å¯æ‰§è¡Œï¼š

```bash
chmod +x loop.sh
```

_æ ¸å¿ƒåŠŸèƒ½ï¼š_ æŒç»­å°†æç¤ºè¯æ–‡ä»¶è¾“å…¥ç»™ claudeï¼Œç®¡ç†è¿­ä»£é™åˆ¶ï¼Œå¹¶åœ¨æ¯æ¬¡ä»»åŠ¡å®Œæˆåæ¨é€æ›´æ”¹ã€‚

### æç¤ºè¯ï¼ˆPROMPTSï¼‰

æ¯æ¬¡å¾ªç¯è¿­ä»£çš„æŒ‡ä»¤é›†ã€‚æ ¹æ®éœ€è¦åœ¨è§„åˆ’å’Œæ„å»ºç‰ˆæœ¬ä¹‹é—´åˆ‡æ¢ã€‚

_æç¤ºè¯ç»“æ„ï¼š_

| éƒ¨åˆ†                   | ç›®çš„                                     |
| ---------------------- | ---------------------------------------- |
| _é˜¶æ®µ 0_ï¼ˆ0a, 0b, 0cï¼‰ | å®šå‘ï¼šç ”è¯»è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ã€æºä»£ç ä½ç½®ã€å½“å‰è®¡åˆ’ |
| _é˜¶æ®µ 1-4_             | ä¸»æŒ‡ä»¤ï¼šä»»åŠ¡ã€éªŒè¯ã€æäº¤                 |
| _999... ç¼–å·_          | æŠ¤æ /ä¸å˜é‡ï¼ˆæ•°å­—è¶Šå¤§ = è¶Šå…³é”®ï¼‰         |

_å…³é”®è¯­è¨€æ¨¡å¼_ï¼ˆGeoff çš„ç‰¹å®šæªè¾ï¼‰ï¼š

- "study"ï¼ˆç ”è¯»ï¼‰ï¼ˆä¸æ˜¯ "read" æˆ– "look at"ï¼‰
- "don't assume not implemented"ï¼ˆä¸è¦å‡è®¾æœªå®ç°ï¼‰ï¼ˆå…³é”®â€”â€”é˜¿å–€ç‰æ–¯ä¹‹è¸µï¼‰
- "using parallel subagents"ï¼ˆä½¿ç”¨å¹¶è¡Œå­ä»£ç†ï¼‰/ "up to N subagents"
- "only 1 subagent for build/tests"ï¼ˆæ„å»º/æµ‹è¯•ä»…ç”¨ 1 ä¸ªå­ä»£ç†ï¼‰ï¼ˆåå‹æ§åˆ¶ï¼‰
- "Think extra hard"ï¼ˆç°ä¸º "Ultrathink"ï¼‰
- "capture the why"ï¼ˆè®°å½•åŸå› ï¼‰
- "keep it up to date"ï¼ˆä¿æŒæ›´æ–°ï¼‰
- "if functionality is missing then it's your job to add it"ï¼ˆå¦‚æœåŠŸèƒ½ç¼ºå¤±é‚£å°±æ˜¯ä½ çš„å·¥ä½œï¼‰
- "resolve them or document them"ï¼ˆè§£å†³æˆ–è®°å½•å®ƒä»¬ï¼‰

#### `PROMPT_plan.md` æ¨¡æ¿

_æ³¨æ„ï¼š_

- æ›´æ–°ä¸‹æ–¹çš„ [project-specific goal]ï¼ˆé¡¹ç›®ç‰¹å®šç›®æ ‡ï¼‰å ä½ç¬¦ã€‚
- å½“å‰å­ä»£ç†åç§°å‡è®¾ä½¿ç”¨ Claudeã€‚

```
0a. Study `specs/*` with up to 250 parallel Sonnet subagents to learn the application specifications.
0b. Study @IMPLEMENTATION_PLAN.md (if present) to understand the plan so far.
0c. Study `src/lib/*` with up to 250 parallel Sonnet subagents to understand shared utilities & components.
0d. For reference, the application source code is in `src/*`.

1. Study @IMPLEMENTATION_PLAN.md (if present; it may be incorrect) and use up to 500 Sonnet subagents to study existing source code in `src/*` and compare it against `specs/*`. Use an Opus subagent to analyze findings, prioritize tasks, and create/update @IMPLEMENTATION_PLAN.md as a bullet point list sorted in priority of items yet to be implemented. Ultrathink. Consider searching for TODO, minimal implementations, placeholders, skipped/flaky tests, and inconsistent patterns. Study @IMPLEMENTATION_PLAN.md to determine starting point for research and keep it up to date with items considered complete/incomplete using subagents.

IMPORTANT: Plan only. Do NOT implement anything. Do NOT assume functionality is missing; confirm with code search first. Treat `src/lib` as the project's standard library for shared utilities and components. Prefer consolidated, idiomatic implementations there over ad-hoc copies.

ULTIMATE GOAL: We want to achieve [project-specific goal]. Consider missing elements and plan accordingly. If an element is missing, search first to confirm it doesn't exist, then if needed author the specification at specs/FILENAME.md. If you create a new element then document the plan to implement it in @IMPLEMENTATION_PLAN.md using a subagent.
```

#### `PROMPT_build.md` æ¨¡æ¿

_æ³¨æ„ï¼š_ å½“å‰å­ä»£ç†åç§°å‡è®¾ä½¿ç”¨ Claudeã€‚

```
0a. Study `specs/*` with up to 500 parallel Sonnet subagents to learn the application specifications.
0b. Study @IMPLEMENTATION_PLAN.md.
0c. For reference, the application source code is in `src/*`.

1. Your task is to implement functionality per the specifications using parallel subagents. Follow @IMPLEMENTATION_PLAN.md and choose the most important item to address. Before making changes, search the codebase (don't assume not implemented) using Sonnet subagents. You may use up to 500 parallel Sonnet subagents for searches/reads and only 1 Sonnet subagent for build/tests. Use Opus subagents when complex reasoning is needed (debugging, architectural decisions).
2. After implementing functionality or resolving problems, run the tests for that unit of code that was improved. If functionality is missing then it's your job to add it as per the application specifications. Ultrathink.
3. When you discover issues, immediately update @IMPLEMENTATION_PLAN.md with your findings using a subagent. When resolved, update and remove the item.
4. When the tests pass, update @IMPLEMENTATION_PLAN.md, then `git add -A` then `git commit` with a message describing the changes. After the commit, `git push`.

99999. Important: When authoring documentation, capture the why â€” tests and implementation importance.
999999. Important: Single sources of truth, no migrations/adapters. If tests unrelated to your work fail, resolve them as part of the increment.
9999999. As soon as there are no build or test errors create a git tag. If there are no git tags start at 0.0.0 and increment patch by 1 for example 0.0.1  if 0.0.0 does not exist.
99999999. You may add extra logging if required to debug issues.
999999999. Keep @IMPLEMENTATION_PLAN.md current with learnings using a subagent â€” future work depends on this to avoid duplicating efforts. Update especially after finishing your turn.
9999999999. When you learn something new about how to run the application, update @AGENTS.md using a subagent but keep it brief. For example if you run commands multiple times before learning the correct command then that file should be updated.
99999999999. For any bugs you notice, resolve them or document them in @IMPLEMENTATION_PLAN.md using a subagent even if it is unrelated to the current piece of work.
999999999999. Implement functionality completely. Placeholders and stubs waste efforts and time redoing the same work.
9999999999999. When @IMPLEMENTATION_PLAN.md becomes large periodically clean out the items that are completed from the file using a subagent.
99999999999999. If you find inconsistencies in the specs/* then use an Opus 4.5 subagent with 'ultrathink' requested to update the specs.
999999999999999. IMPORTANT: Keep @AGENTS.md operational only â€” status updates and progress notes belong in `IMPLEMENTATION_PLAN.md`. A bloated AGENTS.md pollutes every future loop's context.
```

### `AGENTS.md`

å”¯ä¸€çš„ã€æƒå¨çš„"å¾ªç¯æ ¸å¿ƒ"â€”â€”ä¸€ä»½ç®€æ´çš„ã€æ“ä½œæ€§çš„"å¦‚ä½•è¿è¡Œ/æ„å»º"æŒ‡å—ã€‚

- ä¸æ˜¯å˜æ›´æ—¥å¿—æˆ–è¿›åº¦æ—¥è®°
- æè¿°å¦‚ä½•æ„å»º/è¿è¡Œé¡¹ç›®
- è®°å½•æ”¹è¿›å¾ªç¯çš„æ“ä½œæ€§ç»éªŒ
- ä¿æŒç®€çŸ­ï¼ˆçº¦ 60 è¡Œï¼‰

çŠ¶æ€ã€è¿›åº¦å’Œè®¡åˆ’å±äº `IMPLEMENTATION_PLAN.md`ï¼Œä¸å±äºè¿™é‡Œã€‚

_å›ç¯ / å³æ—¶è‡ªæˆ‘è¯„ä¼°ï¼ˆLoopback / Immediate Self-Evaluationï¼‰ï¼š_

AGENTS.md åº”åŒ…å«å¯ç”¨å›ç¯çš„é¡¹ç›®ç‰¹å®šå‘½ä»¤â€”â€”å³ Ralph åœ¨åŒä¸€å¾ªç¯å†…ç«‹å³è¯„ä¼°è‡ªå·±å·¥ä½œçš„èƒ½åŠ›ã€‚è¿™åŒ…æ‹¬ï¼š

- æ„å»ºå‘½ä»¤
- æµ‹è¯•å‘½ä»¤ï¼ˆé’ˆå¯¹æ€§å’Œå…¨å¥—ï¼‰
- ç±»å‹æ£€æŸ¥/ä»£ç æ£€æŸ¥å‘½ä»¤
- ä»»ä½•å…¶ä»–éªŒè¯å·¥å…·

æ„å»ºæç¤ºè¯æ³›æ³›åœ°è¯´"è¿è¡Œæµ‹è¯•"ï¼›AGENTS.md æŒ‡å®šå®é™…å‘½ä»¤ã€‚è¿™å°±æ˜¯åå‹å¦‚ä½•æŒ‰é¡¹ç›®æ¥å…¥çš„æ–¹å¼ã€‚

#### ç¤ºä¾‹

```
## Build & Run

Succinct rules for how to BUILD the project:

## Validation

Run these after implementing to get immediate feedback:

- Tests: `[test command]`
- Typecheck: `[typecheck command]`
- Lint: `[lint command]`

## Operational Notes

Succinct learnings about how to RUN the project:

...

### Codebase Patterns

...
```

### `IMPLEMENTATION_PLAN.md`

ä»å·®è·åˆ†æï¼ˆè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ vs ä»£ç ï¼‰ä¸­å¾—å‡ºçš„ä¼˜å…ˆçº§æ’åºçš„è¦ç‚¹åˆ—è¡¨ä»»åŠ¡â€”â€”ç”± Ralph ç”Ÿæˆã€‚

- _åˆ›å»º_ é€šè¿‡è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰
- _æ›´æ–°_ åœ¨æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰æœŸé—´ï¼ˆæ ‡è®°å®Œæˆã€æ·»åŠ å‘ç°ã€è®°å½•ç¼ºé™·ï¼‰
- _å¯ä»¥é‡æ–°ç”Ÿæˆ_ â€“ Geoffï¼š"æˆ‘å·²ç»å¤šæ¬¡åˆ é™¤äº† TODO åˆ—è¡¨" â†’ åˆ‡æ¢åˆ°è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰
- _è‡ªæˆ‘çº æ­£_ â€“ æ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰ç”šè‡³å¯ä»¥åœ¨ç¼ºå¤±æ—¶åˆ›å»ºæ–°çš„è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰

å¾ªç¯æ€§æ˜¯æœ‰æ„ä¸ºä¹‹çš„ï¼šé€šè¿‡è¿­ä»£å®ç°æœ€ç»ˆä¸€è‡´æ€§ã€‚

_æ— é¢„è®¾æ¨¡æ¿_ - è®© Ralph/LLM è‡ªè¡Œå†³å®šå’Œç®¡ç†æœ€é€‚åˆå®ƒçš„æ ¼å¼ã€‚

### `specs/*`

æ¯ä¸ªå…³æ³¨ä¸»é¢˜ä¸€ä¸ª Markdown æ–‡ä»¶ã€‚è¿™äº›æ˜¯åº”è¯¥æ„å»ºä»€ä¹ˆçš„çœŸå®æ¥æºï¼ˆsource of truthï¼‰ã€‚

- åœ¨éœ€æ±‚é˜¶æ®µåˆ›å»ºï¼ˆäººç±» + LLM å¯¹è¯ï¼‰
- è¢«è§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰å’Œæ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰å…±åŒä½¿ç”¨
- å¦‚æœå‘ç°ä¸ä¸€è‡´å¯ä»¥æ›´æ–°ï¼ˆç½•è§ï¼Œä½¿ç”¨å­ä»£ç†ï¼‰

_æ— é¢„è®¾æ¨¡æ¿_ - è®© Ralph/LLM è‡ªè¡Œå†³å®šå’Œç®¡ç†æœ€é€‚åˆå®ƒçš„æ ¼å¼ã€‚

### `src/` å’Œ `src/lib/`

åº”ç”¨æºä»£ç å’Œå…±äº«å·¥å…·å‡½æ•°/ç»„ä»¶ã€‚

åœ¨ `PROMPT.md` æ¨¡æ¿ä¸­ç”¨äºå®šå‘æ­¥éª¤çš„å¼•ç”¨ã€‚

---

## å¢å¼ºæ–¹æ¡ˆï¼Ÿï¼ˆEnhancementsï¼‰

æˆ‘ï¼ˆClaytonï¼‰ä»åœ¨è¯„ä¼°è¿™äº›å¯èƒ½å¢å¼ºæ–¹æ¡ˆçš„ä»·å€¼å’Œå¯è¡Œæ€§ï¼Œä½†è¿™äº›æœºä¼šå¬èµ·æ¥å¾ˆæœ‰å‰æ™¯ã€‚

- [ä½¿ç”¨ Claude çš„ AskUserQuestionTool è¿›è¡Œè§„åˆ’](#ä½¿ç”¨-claude-çš„-askuserquestiontool-è¿›è¡Œè§„åˆ’) - ä½¿ç”¨ Claude å†…ç½®çš„è®¿è°ˆå·¥å…·æ¥ç³»ç»Ÿæ€§åœ°æ¾„æ¸… JTBDã€è¾¹ç•Œæƒ…å†µå’Œè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰çš„éªŒæ”¶æ ‡å‡†ã€‚
- [éªŒæ”¶é©±åŠ¨çš„åå‹ï¼ˆAcceptance-Driven Backpressureï¼‰](#éªŒæ”¶é©±åŠ¨çš„åå‹acceptance-driven-backpressure) - åœ¨è§„åˆ’é˜¶æ®µä»éªŒæ”¶æ ‡å‡†ä¸­æ¨å¯¼æµ‹è¯•éœ€æ±‚ã€‚é˜²æ­¢"ä½œå¼Š"â€”â€”æ²¡æœ‰é€‚å½“çš„æµ‹è¯•é€šè¿‡å°±ä¸èƒ½å£°ç§°å®Œæˆã€‚
- [éç¡®å®šæ€§åå‹ï¼ˆNon-Deterministic Backpressureï¼‰](#éç¡®å®šæ€§åå‹non-deterministic-backpressure) - ä½¿ç”¨ LLM ä½œä¸ºè¯„å®¡æ¥æµ‹è¯•ä¸»è§‚ä»»åŠ¡ï¼ˆè¯­æ°”ã€ç¾å­¦ã€ç”¨æˆ·ä½“éªŒï¼‰ã€‚äºŒå…ƒé€šè¿‡/å¤±è´¥å®¡æŸ¥ï¼Œè¿­ä»£ç›´åˆ°é€šè¿‡ã€‚
- [Ralph å‹å¥½çš„å·¥ä½œåˆ†æ”¯ï¼ˆRalph-Friendly Work Branchesï¼‰](#ralph-å‹å¥½çš„å·¥ä½œåˆ†æ”¯ralph-friendly-work-branches) - åœ¨è¿è¡Œæ—¶è¦æ±‚ Ralph "è¿‡æ»¤åˆ°åŠŸèƒ½ X"æ˜¯ä¸å¯é çš„ã€‚ç›¸åï¼Œåœ¨å‰æœŸä¸ºæ¯ä¸ªåˆ†æ”¯åˆ›å»ºæœ‰èŒƒå›´çš„è®¡åˆ’ã€‚
- [JTBD â†’ æ•…äº‹åœ°å›¾ â†’ SLC å‘å¸ƒ](#jtbd--æ•…äº‹åœ°å›¾story-map-slc-å‘å¸ƒ) - å°†"è®© Ralph åš Ralph"çš„åŠ›é‡æ¨è¿›åˆ°å°† JTBD çš„å—ä¼—å’Œæ´»åŠ¨è¿æ¥åˆ°ç®€å•/å¯çˆ±/å®Œæ•´ï¼ˆSimple/Lovable/Completeï¼‰çš„å‘å¸ƒã€‚

---

### ä½¿ç”¨ Claude çš„ AskUserQuestionTool è¿›è¡Œè§„åˆ’

åœ¨é˜¶æ®µä¸€ï¼ˆå®šä¹‰éœ€æ±‚ï¼‰ä¸­ï¼Œä½¿ç”¨ Claude å†…ç½®çš„ `AskUserQuestionTool`ï¼Œé€šè¿‡ç»“æ„åŒ–è®¿è°ˆæ¥ç³»ç»Ÿæ€§åœ°æ¢ç´¢ JTBDã€å…³æ³¨ä¸»é¢˜ã€è¾¹ç•Œæƒ…å†µå’ŒéªŒæ”¶æ ‡å‡†ï¼Œç„¶åå†ç¼–å†™è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ã€‚

_ä½•æ—¶ä½¿ç”¨ï¼š_ åˆå§‹éœ€æ±‚æç®€/æ¨¡ç³Šï¼Œéœ€è¦æ¾„æ¸…çº¦æŸæ¡ä»¶ï¼Œæˆ–å­˜åœ¨å¤šç§æœ‰æ•ˆæ–¹æ¡ˆã€‚

_è°ƒç”¨æ–¹å¼ï¼š_ "Interview me using AskUserQuestion to understand [JTBD/topic/acceptance criteria/...]"ï¼ˆä½¿ç”¨ AskUserQuestion é‡‡è®¿æˆ‘ä»¥äº†è§£ [JTBD/ä¸»é¢˜/éªŒæ”¶æ ‡å‡†/...]ï¼‰

Claude ä¼šæå‡ºæœ‰é’ˆå¯¹æ€§çš„é—®é¢˜æ¥æ¾„æ¸…éœ€æ±‚å¹¶ç¡®ä¿åœ¨ç”Ÿæˆ `specs/*.md` æ–‡ä»¶ä¹‹å‰è¾¾æˆä¸€è‡´ã€‚

_æµç¨‹ï¼š_

1. ä»å·²çŸ¥ä¿¡æ¯å¼€å§‹ â†’
2. _Claude é€šè¿‡ AskUserQuestion è¿›è¡Œè®¿è°ˆ_ â†’
3. è¿­ä»£ç›´åˆ°æ¸…æ™° â†’
4. Claude ç¼–å†™åŒ…å«éªŒæ”¶æ ‡å‡†çš„è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ â†’
5. è¿›å…¥è§„åˆ’/æ„å»ºé˜¶æ®µ

ä¸éœ€è¦ä»»ä½•ä»£ç æˆ–æç¤ºè¯å˜æ›´â€”â€”è¿™åªæ˜¯åˆ©ç”¨ç°æœ‰çš„ Claude Code åŠŸèƒ½æ¥å¢å¼ºé˜¶æ®µä¸€ã€‚

_çµæ„Ÿæ¥æº_ - [Thariq çš„ X å¸–å­](https://x.com/trq212/status/2005315275026260309)ï¼š

---

### éªŒæ”¶é©±åŠ¨çš„åå‹ï¼ˆAcceptance-Driven Backpressureï¼‰

Geoff çš„ Ralph _éšå¼åœ°_ é€šè¿‡æ¶Œç°è¿­ä»£ï¼ˆemergent iterationï¼‰å°†è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ â†’ å®æ–½ â†’ æµ‹è¯•è¿æ¥èµ·æ¥ã€‚è¿™ä¸ªå¢å¼ºæ–¹æ¡ˆä¼šé€šè¿‡åœ¨è§„åˆ’é˜¶æ®µæ¨å¯¼æµ‹è¯•éœ€æ±‚æ¥ä½¿è¿™ç§è¿æ¥*æ˜¾å¼åŒ–*ï¼Œå»ºç«‹ä»"æˆåŠŸæ˜¯ä»€ä¹ˆæ ·å­"åˆ°"ä»€ä¹ˆæ¥éªŒè¯å®ƒ"çš„ç›´æ¥å…³è”ã€‚

è¿™ä¸ªå¢å¼ºæ–¹æ¡ˆå°†éªŒæ”¶æ ‡å‡†ï¼ˆåœ¨è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ä¸­ï¼‰ç›´æ¥è¿æ¥åˆ°æµ‹è¯•éœ€æ±‚ï¼ˆåœ¨å®æ–½è®¡åˆ’ä¸­ï¼‰ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼æé«˜åå‹è´¨é‡ï¼š

- _é˜²æ­¢"ä½œå¼Š"_ - æ²¡æœ‰ä»éªŒæ”¶æ ‡å‡†æ¨å¯¼å‡ºçš„å¿…è¦æµ‹è¯•é€šè¿‡ï¼Œå°±ä¸èƒ½å£°ç§°å®Œæˆ
- _å¯ç”¨ TDD å·¥ä½œæµ_ - åœ¨å®æ–½å¼€å§‹å‰å°±çŸ¥é“æµ‹è¯•éœ€æ±‚
- _æ”¹å–„æ”¶æ•›æ€§_ - æ¸…æ™°çš„å®Œæˆä¿¡å·ï¼ˆå¿…è¦æµ‹è¯•é€šè¿‡ï¼‰vs æ¨¡ç³Šçš„ï¼ˆ"å¥½åƒåšå®Œäº†ï¼Ÿ"ï¼‰
- _ç»´æŒç¡®å®šæ€§_ - æµ‹è¯•éœ€æ±‚åœ¨è®¡åˆ’ä¸­ï¼ˆå·²çŸ¥çŠ¶æ€ï¼‰è€Œéæ¶Œç°çš„ï¼ˆæ¦‚ç‡æ€§çš„ï¼‰

#### ä¸æ ¸å¿ƒç†å¿µçš„å…¼å®¹æ€§

| åŸåˆ™                             | æ˜¯å¦ä¿æŒï¼Ÿ | å¦‚ä½•ä¿æŒ                               |
| -------------------------------- | ---------- | -------------------------------------- |
| å•ä½“æ“ä½œï¼ˆMonolithic operationï¼‰ | âœ… æ˜¯      | ä¸€ä¸ªä»£ç†ï¼Œä¸€ä¸ªä»»åŠ¡ï¼Œä¸€æ¬¡ä¸€ä¸ªå¾ªç¯       |
| åå‹è‡³å…³é‡è¦                     | âœ… æ˜¯      | æµ‹è¯•æ˜¯æœºåˆ¶ï¼Œåªæ˜¯ç°åœ¨æ˜¾å¼æ¨å¯¼äº†         |
| ä¸Šä¸‹æ–‡æ•ˆç‡                       | âœ… æ˜¯      | è§„åˆ’ä¸€æ¬¡æ€§ç¡®å®šæµ‹è¯• vs æ„å»ºæ—¶é‡å¤å‘ç°   |
| ç¡®å®šæ€§è®¾ç½®                       | âœ… æ˜¯      | æµ‹è¯•éœ€æ±‚åœ¨è®¡åˆ’ä¸­ï¼ˆå·²çŸ¥çŠ¶æ€ï¼‰è€Œéæ¶Œç°çš„ |
| è®© Ralph åš Ralph                | âœ… æ˜¯      | Ralph ä»ç„¶ä¼˜å…ˆæ’åºå¹¶é€‰æ‹©å®æ–½æ–¹æ¡ˆ       |
| è®¡åˆ’å¯ä¸¢å¼ƒ                       | âœ… æ˜¯      | æµ‹è¯•éœ€æ±‚é”™äº†ï¼Ÿé‡æ–°ç”Ÿæˆè®¡åˆ’             |
| "è®°å½•åŸå› "                       | âœ… æ˜¯      | æµ‹è¯•æ„å›¾åœ¨å®æ–½å‰è®°å½•åœ¨è®¡åˆ’ä¸­           |
| ä¸ä½œå¼Š                           | âœ… æ˜¯      | å¿…è¦æµ‹è¯•é˜²æ­¢å ä½ç¬¦å¼å®æ–½               |

#### è§„èŒƒæ€§çš„å¹³è¡¡

å…³é”®åŒºåˆ†ï¼š

_éªŒæ”¶æ ‡å‡†_ï¼ˆåœ¨è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ä¸­ï¼‰= è¡Œä¸ºç»“æœï¼Œå¯è§‚å¯Ÿçš„ç»“æœï¼ŒæˆåŠŸæ˜¯ä»€ä¹ˆæ ·å­

- âœ… "ä»ä»»ä½•ä¸Šä¼ çš„å›¾åƒä¸­æå– 5-10 ä¸ªä¸»è‰²è°ƒ"
- âœ… "å¤„ç† <5MB çš„å›¾åƒåœ¨ <100ms å†…å®Œæˆ"
- âœ… "å¤„ç†è¾¹ç•Œæƒ…å†µï¼šç°åº¦å›¾ã€å•è‰²å›¾ã€é€æ˜èƒŒæ™¯"

_æµ‹è¯•éœ€æ±‚_ï¼ˆåœ¨å®æ–½è®¡åˆ’ä¸­ï¼‰= ä»éªŒæ”¶æ ‡å‡†æ¨å¯¼å‡ºçš„éªŒè¯ç‚¹

- âœ… "å¿…è¦æµ‹è¯•ï¼šæå– 5-10 ä¸ªé¢œè‰²ï¼Œæ€§èƒ½ <100msï¼Œå¤„ç†ç°åº¦è¾¹ç•Œæƒ…å†µ"

_å®æ–½æ–¹æ¡ˆ_ï¼ˆç”± Ralph å†³å®šï¼‰= å…³äºå¦‚ä½•å®ç°çš„æŠ€æœ¯å†³ç­–

- âŒ "ä½¿ç”¨ K-means èšç±»ï¼Œ3 æ¬¡è¿­ä»£å’Œ LAB è‰²å½©ç©ºé—´è½¬æ¢"

å…³é”®ï¼š_æŒ‡å®šéªŒè¯ä»€ä¹ˆï¼ˆç»“æœï¼‰ï¼Œè€Œéå¦‚ä½•å®æ–½ï¼ˆæ–¹æ³•ï¼‰_

è¿™ç»´æŒäº†"è®© Ralph åš Ralph"çš„åŸåˆ™â€”â€”Ralph å†³å®šå®æ–½ç»†èŠ‚ï¼ŒåŒæ—¶æ‹¥æœ‰æ¸…æ™°çš„æˆåŠŸä¿¡å·ã€‚

#### æ¶æ„ï¼šä¸‰é˜¶æ®µè¿æ¥

```
Phase 1: Requirements Definition
    specs/*.md + Acceptance Criteria
    â†“
Phase 2: Planning (derives test requirements)
    IMPLEMENTATION_PLAN.md + Required Tests
    â†“
Phase 3: Building (implements with tests)
    Implementation + Tests â†’ Backpressure
```

#### é˜¶æ®µä¸€ï¼šéœ€æ±‚å®šä¹‰

åœ¨äº§å‡ºè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰çš„äººç±» + LLM å¯¹è¯è¿‡ç¨‹ä¸­ï¼š

- è®¨è®º JTBD å¹¶æ‹†åˆ†ä¸ºå…³æ³¨ä¸»é¢˜
- æ ¹æ®éœ€è¦ä½¿ç”¨å­ä»£ç†åŠ è½½å¤–éƒ¨ä¸Šä¸‹æ–‡
- _è®¨è®ºå¹¶å®šä¹‰éªŒæ”¶æ ‡å‡†_ - ä»€ä¹ˆå¯è§‚å¯Ÿçš„ã€å¯éªŒè¯çš„ç»“æœè¡¨æ˜æˆåŠŸ
- ä¿æŒæ ‡å‡†æ˜¯è¡Œä¸ºæ€§çš„ï¼ˆç»“æœï¼‰ï¼Œè€Œéå®æ–½æ€§çš„ï¼ˆå¦‚ä½•æ„å»ºï¼‰
- LLM ä»¥æœ€åˆç†çš„æ–¹å¼ç¼–å†™åŒ…å«éªŒæ”¶æ ‡å‡†çš„è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰
- éªŒæ”¶æ ‡å‡†æˆä¸ºåœ¨è§„åˆ’é˜¶æ®µæ¨å¯¼æµ‹è¯•éœ€æ±‚çš„åŸºç¡€

#### é˜¶æ®µäºŒï¼šè§„åˆ’æ¨¡å¼ï¼ˆPLANNING modeï¼‰å¢å¼º

ä¿®æ”¹ `PROMPT_plan.md` çš„æŒ‡ä»¤ 1 ä»¥åŒ…å«æµ‹è¯•æ¨å¯¼ã€‚åœ¨ç¬¬ä¸€å¥ä¹‹åæ·»åŠ ï¼š

```markdown
For each task in the plan, derive required tests from acceptance criteria in specs - what specific outcomes need verification (behavior, performance, edge cases). Tests verify WHAT works, not HOW it's implemented. Include as part of task definition.
```

#### é˜¶æ®µä¸‰ï¼šæ„å»ºæ¨¡å¼ï¼ˆBUILDING modeï¼‰å¢å¼º

ä¿®æ”¹ `PROMPT_build.md` æŒ‡ä»¤ï¼š

_æŒ‡ä»¤ 1ï¼š_ åœ¨ "choose the most important item to address" ä¹‹åæ·»åŠ ï¼š

```markdown
Tasks include required tests - implement tests as part of task scope.
```

_æŒ‡ä»¤ 2ï¼š_ å°† "run the tests for that unit of code" æ›¿æ¢ä¸ºï¼š

```markdown
run all required tests specified in the task definition. All required tests must exist and pass before the task is considered complete.
```

_åœ¨ 9 ç³»åˆ—åºåˆ—ä¸­å‰ç½®æ–°æŠ¤æ ï¼š_

```markdown
999. Required tests derived from acceptance criteria must exist and pass before committing. Tests are part of implementation scope, not optional. Test-driven development approach: tests can be written first or alongside implementation.
```

---

### éç¡®å®šæ€§åå‹ï¼ˆNon-Deterministic Backpressureï¼‰

æŸäº›éªŒæ”¶æ ‡å‡†æ— æ³•é€šè¿‡ç¨‹åºåŒ–éªŒè¯ï¼š

- _åˆ›æ„è´¨é‡_ - å†™ä½œè¯­æ°”ã€å™äº‹æµç•…åº¦ã€å¸å¼•åŠ›
- _ç¾å­¦åˆ¤æ–­_ - è§†è§‰å’Œè°ã€è®¾è®¡å¹³è¡¡ã€å“ç‰Œä¸€è‡´æ€§
- _ç”¨æˆ·ä½“éªŒè´¨é‡_ - ç›´è§‰å¼å¯¼èˆªã€æ¸…æ™°çš„ä¿¡æ¯å±‚æ¬¡
- _å†…å®¹é€‚å½“æ€§_ - ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„ä¿¡æ¯ä¼ è¾¾ã€å—ä¼—é€‚é…

è¿™äº›éœ€è¦ç±»äººåˆ¤æ–­ï¼Œä½†ä¹Ÿéœ€è¦åå‹æ¥ç¡®ä¿åœ¨æ„å»ºå¾ªç¯ä¸­æ»¡è¶³éªŒæ”¶æ ‡å‡†ã€‚

_è§£å†³æ–¹æ¡ˆï¼š_ æ·»åŠ  LLM ä½œä¸ºè¯„å®¡ï¼ˆLLM-as-Judgeï¼‰æµ‹è¯•ä½œä¸ºå…·æœ‰äºŒå…ƒé€šè¿‡/å¤±è´¥ç»“æœçš„åå‹ã€‚

LLM å®¡æŸ¥æ˜¯éç¡®å®šæ€§çš„ï¼ˆåŒä¸€äº§ç‰©åœ¨ä¸åŒè¿è¡Œä¸­å¯èƒ½æ”¶åˆ°ä¸åŒåˆ¤æ–­ï¼‰ã€‚è¿™ä¸ Ralph çš„ç†å¿µä¸€è‡´ï¼š"åœ¨éç¡®å®šæ€§ä¸–ç•Œä¸­åšåˆ°ç¡®å®šæ€§åœ°ä¸å¥½ã€‚" å¾ªç¯é€šè¿‡è¿­ä»£æä¾›æœ€ç»ˆä¸€è‡´æ€§â€”â€”å®¡æŸ¥è¿è¡Œç›´åˆ°é€šè¿‡ï¼Œæ¥å—è‡ªç„¶æ–¹å·®ã€‚

#### éœ€è¦åˆ›å»ºä»€ä¹ˆï¼ˆç¬¬ä¸€æ­¥ï¼‰

åœ¨ `src/lib/` ä¸­åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š

```
src/lib/
  llm-review.ts          # æ ¸å¿ƒå·¥å…· - å•ä¸€å‡½æ•°ï¼Œç®€æ´ API
  llm-review.test.ts     # å‚è€ƒç¤ºä¾‹ï¼Œå±•ç¤ºä½¿ç”¨æ¨¡å¼ï¼ˆRalph ä»ä¸­å­¦ä¹ ï¼‰
```

##### `llm-review.ts` - Ralph å¯å‘ç°çš„äºŒå…ƒé€šè¿‡/å¤±è´¥ APIï¼š

```typescript
interface ReviewResult {
  pass: boolean;
  feedback?: string; // Only present when pass=false
}

function createReview(config: {
  criteria: string; // What to evaluate (behavioral, observable)
  artifact: string; // Text content OR screenshot path
  intelligence?: "fast" | "smart"; // Optional, defaults to 'fast'
}): Promise<ReviewResult>;
```

_å¤šæ¨¡æ€æ”¯æŒï¼š_ ä¸¤ç§æ™ºèƒ½çº§åˆ«éƒ½ä½¿ç”¨å¤šæ¨¡æ€æ¨¡å‹ï¼ˆæ–‡æœ¬ + è§†è§‰ï¼‰ã€‚äº§ç‰©ç±»å‹æ£€æµ‹æ˜¯è‡ªåŠ¨çš„ï¼š

- æ–‡æœ¬è¯„ä¼°ï¼š`artifact: "Your content here"` â†’ ä½œä¸ºæ–‡æœ¬è¾“å…¥è·¯ç”±
- è§†è§‰è¯„ä¼°ï¼š`artifact: "./tmp/screenshot.png"` â†’ ä½œä¸ºè§†è§‰è¾“å…¥è·¯ç”±ï¼ˆæ£€æµ‹ .png, .jpg, .jpeg æ‰©å±•åï¼‰

_æ™ºèƒ½çº§åˆ«_ï¼ˆåˆ¤æ–­è´¨é‡ï¼Œè€Œéèƒ½åŠ›ç±»å‹ï¼‰ï¼š

- `fast`ï¼ˆé»˜è®¤ï¼‰ï¼šå¿«é€Ÿã€ä½æˆæœ¬çš„æ¨¡å‹ï¼Œç”¨äºç›´æ¥çš„è¯„ä¼°
  - ç¤ºä¾‹ï¼šGemini 3.0 Flashï¼ˆå¤šæ¨¡æ€ã€å¿«é€Ÿã€å»‰ä»·ï¼‰
- `smart`ï¼šæ›´é«˜è´¨é‡çš„æ¨¡å‹ï¼Œç”¨äºç»†è‡´çš„ç¾å­¦/åˆ›æ„åˆ¤æ–­
  - ç¤ºä¾‹ï¼šGPT 5.1ï¼ˆå¤šæ¨¡æ€ã€æ›´å¥½çš„åˆ¤æ–­åŠ›ã€æ›´é«˜æˆæœ¬ï¼‰

å·¥å…·å‡½æ•°çš„å®ç°è´Ÿè´£é€‰æ‹©åˆé€‚çš„æ¨¡å‹ã€‚ï¼ˆç¤ºä¾‹æ˜¯å½“å‰çš„é€‰é¡¹ï¼Œä¸æ˜¯è¦æ±‚ã€‚ï¼‰

##### `llm-review.test.ts` - å‘ Ralph å±•ç¤ºå¦‚ä½•ä½¿ç”¨ï¼ˆæ–‡æœ¬å’Œè§†è§‰ç¤ºä¾‹ï¼‰ï¼š

```typescript
import { createReview } from "@/lib/llm-review";

// Example 1: Text evaluation
test("welcome message tone", async () => {
  const message = generateWelcomeMessage();
  const result = await createReview({
    criteria:
      "Message uses warm, conversational tone appropriate for design professionals while clearly conveying value proposition",
    artifact: message, // Text content
  });
  expect(result.pass).toBe(true);
});

// Example 2: Vision evaluation (screenshot path)
test("dashboard visual hierarchy", async () => {
  await page.screenshot({ path: "./tmp/dashboard.png" });
  const result = await createReview({
    criteria:
      "Layout demonstrates clear visual hierarchy with obvious primary action",
    artifact: "./tmp/dashboard.png", // Screenshot path
  });
  expect(result.pass).toBe(true);
});

// Example 3: Smart intelligence for complex judgment
test("brand visual consistency", async () => {
  await page.screenshot({ path: "./tmp/homepage.png" });
  const result = await createReview({
    criteria:
      "Visual design maintains professional brand identity suitable for financial services while avoiding corporate sterility",
    artifact: "./tmp/homepage.png",
    intelligence: "smart", // Complex aesthetic judgment
  });
  expect(result.pass).toBe(true);
});
```

_Ralph ä»è¿™äº›ç¤ºä¾‹ä¸­å­¦ä¹ ï¼š_ æ–‡æœ¬å’Œæˆªå›¾éƒ½å¯ä»¥ä½œä¸ºäº§ç‰©ä½¿ç”¨ã€‚æ ¹æ®éœ€è¦è¯„ä¼°çš„å†…å®¹æ¥é€‰æ‹©ã€‚å·¥å…·å‡½æ•°åœ¨å†…éƒ¨å¤„ç†å…¶ä½™éƒ¨åˆ†ã€‚

_æœªæ¥å¯æ‰©å±•æ€§ï¼š_ å½“å‰è®¾è®¡ä¸ºäº†ç®€æ´ä½¿ç”¨å•ä¸€çš„ `artifact: string`ã€‚å¦‚æœå‡ºç°æ˜ç¡®çš„æ¨¡å¼éœ€è¦å¤šä¸ªäº§ç‰©ï¼ˆå‰åå¯¹æ¯”ã€è·¨é¡¹ç›®ä¸€è‡´æ€§ã€å¤šè§’åº¦è¯„ä¼°ï¼‰ï¼Œå¯ä»¥æ‰©å±•ä¸º `artifact: string | string[]`ã€‚ç»„åˆæˆªå›¾æˆ–æ‹¼æ¥æ–‡æœ¬å¯ä»¥å¤„ç†å¤§å¤šæ•°å¤šé¡¹ç›®éœ€æ±‚ã€‚

#### ä¸ Ralph å·¥ä½œæµçš„é›†æˆ

_è§„åˆ’é˜¶æ®µ_ - æ›´æ–° `PROMPT_plan.md`ï¼š

åœ¨ä»¥ä¸‹å†…å®¹ä¹‹åï¼š

```
...Study @IMPLEMENTATION_PLAN.md to determine starting point for research and keep it up to date with items considered complete/incomplete using subagents.
```

æ’å…¥è¿™æ®µï¼š

```
When deriving test requirements from acceptance criteria, identify whether verification requires programmatic validation (measurable, inspectable) or human-like judgment (perceptual quality, tone, aesthetics). Both types are equally valid backpressure mechanisms. For subjective criteria that resist programmatic validation, explore src/lib for non-deterministic evaluation patterns.
```

_æ„å»ºé˜¶æ®µ_ - æ›´æ–° `PROMPT_build.md`ï¼š

åœ¨ 9 ç³»åˆ—åºåˆ—ä¸­å‰ç½®æ–°æŠ¤æ ï¼š

```markdown
9999. Create tests to verify implementation meets acceptance criteria and include both conventional tests (behavior, performance, correctness) and perceptual quality tests (for subjective criteria, see src/lib patterns).
```

_å‘ç°è€Œéæ–‡æ¡£åŒ–ï¼ˆDiscovery, not documentationï¼‰ï¼š_ Ralph åœ¨ `src/lib` æ¢ç´¢é˜¶æ®µï¼ˆPhase 0cï¼‰ä» `llm-review.test.ts` ç¤ºä¾‹ä¸­å­¦ä¹  LLM å®¡æŸ¥æ¨¡å¼ã€‚æ— éœ€æ›´æ–° AGENTS.mdâ€”â€”ä»£ç ç¤ºä¾‹å°±æ˜¯æ–‡æ¡£ã€‚

#### ä¸æ ¸å¿ƒç†å¿µçš„å…¼å®¹æ€§

| åŸåˆ™              | æ˜¯å¦ä¿æŒï¼Ÿ | å¦‚ä½•ä¿æŒ                                                                           |
| ----------------- | ---------- | ---------------------------------------------------------------------------------- |
| åå‹è‡³å…³é‡è¦      | âœ… æ˜¯      | å°†åå‹æ‰©å±•åˆ°éç¨‹åºåŒ–éªŒæ”¶                                                           |
| ç¡®å®šæ€§è®¾ç½®        | âš ï¸ éƒ¨åˆ†    | æ ‡å‡†åœ¨è®¡åˆ’ä¸­ï¼ˆç¡®å®šæ€§ï¼‰ï¼Œè¯„ä¼°æ˜¯éç¡®å®šæ€§çš„ä½†é€šè¿‡è¿­ä»£æ”¶æ•›ã€‚è¿™æ˜¯å¯¹ä¸»è§‚è´¨é‡çš„æœ‰æ„æƒè¡¡ã€‚ |
| ä¸Šä¸‹æ–‡æ•ˆç‡        | âœ… æ˜¯      | å·¥å…·å‡½æ•°é€šè¿‡ `src/lib` å¤ç”¨ï¼Œæµ‹è¯•å®šä¹‰ä½“ç§¯å°                                        |
| è®© Ralph åš Ralph | âœ… æ˜¯      | Ralph å‘ç°æ¨¡å¼ï¼Œé€‰æ‹©ä½•æ—¶ä½¿ç”¨ï¼Œç¼–å†™æ ‡å‡†                                             |
| è®¡åˆ’å¯ä¸¢å¼ƒ        | âœ… æ˜¯      | å®¡æŸ¥éœ€æ±‚æ˜¯è®¡åˆ’çš„ä¸€éƒ¨åˆ†ï¼Œé”™äº†å°±é‡æ–°ç”Ÿæˆ                                             |
| ç®€æ´è‡³ä¸Š          | âœ… æ˜¯      | å•ä¸€å‡½æ•°ï¼ŒäºŒå…ƒç»“æœï¼Œæ— è¯„åˆ†å¤æ‚æ€§                                                   |
| ä¸º Ralph æ·»åŠ ä¿¡å· | âœ… æ˜¯      | è½»é‡çº§æç¤ºè¯è¡¥å……ï¼Œä»ä»£ç æ¢ç´¢ä¸­å­¦ä¹                                                  |

---

### Ralph å‹å¥½çš„å·¥ä½œåˆ†æ”¯ï¼ˆRalph-Friendly Work Branchesï¼‰

_å…³é”®åŸåˆ™ï¼š_ Geoff çš„ Ralph ä»å•ä¸€çš„ã€å¯ä¸¢å¼ƒçš„è®¡åˆ’ä¸­å·¥ä½œï¼Œç”± Ralph é€‰æ‹©"æœ€é‡è¦çš„"ã€‚è¦åœ¨ä½¿ç”¨åˆ†æ”¯çš„åŒæ—¶ç»´æŒè¿™ä¸ªæ¨¡å¼ï¼Œä½ å¿…é¡»åœ¨è®¡åˆ’åˆ›å»ºæ—¶é™å®šèŒƒå›´ï¼Œè€Œéåœ¨ä»»åŠ¡é€‰æ‹©æ—¶ã€‚

_ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼š_

- âŒ _é”™è¯¯æ–¹æ³•_ï¼šåˆ›å»ºå®Œæ•´è®¡åˆ’ï¼Œç„¶åè¦æ±‚ Ralph åœ¨è¿è¡Œæ—¶"è¿‡æ»¤"ä»»åŠ¡ â†’ ä¸å¯é ï¼ˆ70-80%ï¼‰ï¼Œè¿åç¡®å®šæ€§
- âœ… _æ­£ç¡®æ–¹æ³•_ï¼šä¸ºæ¯ä¸ªå·¥ä½œåˆ†æ”¯æå‰åˆ›å»ºæœ‰èŒƒå›´é™å®šçš„è®¡åˆ’ â†’ ç¡®å®šæ€§ã€ç®€å•ã€ç»´æŒ"è®¡åˆ’å¯ä¸¢å¼ƒ"

_è§£å†³æ–¹æ¡ˆï¼š_ æ·»åŠ  `plan-work` æ¨¡å¼æ¥åœ¨å½“å‰åˆ†æ”¯ä¸Šåˆ›å»ºå·¥ä½œèŒƒå›´é™å®šçš„ IMPLEMENTATION_PLAN.mdã€‚ç”¨æˆ·åˆ›å»ºå·¥ä½œåˆ†æ”¯ï¼Œç„¶åä½¿ç”¨è‡ªç„¶è¯­è¨€æè¿°å·¥ä½œé‡ç‚¹æ¥è¿è¡Œ `plan-work`ã€‚LLM ä½¿ç”¨æ­¤æè¿°æ¥é™å®šè®¡åˆ’èŒƒå›´ã€‚è§„åˆ’å®Œæˆåï¼ŒRalph ä»å·²é™å®šèŒƒå›´çš„è®¡åˆ’ä¸­æ„å»ºï¼Œæ— éœ€ä»»ä½•è¯­ä¹‰è¿‡æ»¤â€”â€”åƒå¾€å¸¸ä¸€æ ·é€‰æ‹©"æœ€é‡è¦çš„"ã€‚

_æœ¯è¯­ï¼š_ "å·¥ä½œï¼ˆWorkï¼‰"æ•…æ„ä½¿ç”¨å®½æ³›çš„å«ä¹‰â€”â€”å®ƒå¯ä»¥æè¿°åŠŸèƒ½ç‰¹æ€§ã€å…³æ³¨ä¸»é¢˜ã€é‡æ„å·¥ä½œã€åŸºç¡€è®¾æ–½å˜æ›´ã€ç¼ºé™·ä¿®å¤æˆ–ä»»ä½•å…·æœ‰å†…èšæ€§çš„ç›¸å…³å˜æ›´ä½“ã€‚ä½ ä¼ é€’ç»™ `plan-work` çš„å·¥ä½œæè¿°æ˜¯ç»™ LLM çš„è‡ªç„¶è¯­è¨€â€”â€”å¯ä»¥æ˜¯æ•£æ–‡ï¼Œä¸å— git åˆ†æ”¯å‘½åè§„åˆ™çš„çº¦æŸã€‚

#### è®¾è®¡åŸåˆ™

- âœ… *æ¯ä¸ª Ralph ä¼šè¯åœ¨ä¸€ä¸ªåˆ†æ”¯ä¸Šå•ä½“è¿è¡Œ*ä¸€ä¸ªå·¥ä½œä½“
- âœ… _ç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºåˆ†æ”¯_ - å®Œå…¨æ§åˆ¶å‘½åçº¦å®šå’Œç­–ç•¥ï¼ˆå¦‚ worktreeï¼‰
- âœ… _è‡ªç„¶è¯­è¨€å·¥ä½œæè¿°_ - å‘ LLM ä¼ é€’æ•£æ–‡ï¼Œä¸å— git å‘½åè§„åˆ™çº¦æŸ
- âœ… _åœ¨è®¡åˆ’åˆ›å»ºæ—¶é™å®šèŒƒå›´_ï¼ˆç¡®å®šæ€§ï¼‰è€Œéä»»åŠ¡é€‰æ‹©æ—¶ï¼ˆæ¦‚ç‡æ€§ï¼‰
- âœ… _æ¯ä¸ªåˆ†æ”¯å•ä¸€è®¡åˆ’_ - æ¯ä¸ªåˆ†æ”¯ä¸€ä¸ª IMPLEMENTATION_PLAN.md
- âœ… _è®¡åˆ’ä¿æŒå¯ä¸¢å¼ƒ_ - å½“åˆ†æ”¯çš„è®¡åˆ’é”™è¯¯/è¿‡æ—¶æ—¶é‡æ–°ç”Ÿæˆæœ‰èŒƒå›´çš„è®¡åˆ’
- âœ… å¾ªç¯ä¼šè¯å†…ä¸åŠ¨æ€åˆ‡æ¢åˆ†æ”¯
- âœ… ç»´æŒç®€æ´æ€§å’Œç¡®å®šæ€§
- âœ… å¯é€‰â€”â€”ä¸»åˆ†æ”¯å·¥ä½œæµä»ç„¶æœ‰æ•ˆ
- âœ… æ„å»ºæ—¶æ— è¯­ä¹‰è¿‡æ»¤â€”â€”Ralph åªé€‰æ‹©"æœ€é‡è¦çš„"

#### å·¥ä½œæµç¨‹

_1. å®Œæ•´è§„åˆ’ï¼ˆåœ¨ä¸»åˆ†æ”¯ä¸Šï¼‰_

```bash
./loop.sh plan
# ä¸ºæ•´ä¸ªé¡¹ç›®ç”Ÿæˆå®Œæ•´çš„ IMPLEMENTATION_PLAN.md
```

_2. åˆ›å»ºå·¥ä½œåˆ†æ”¯_

ç”¨æˆ·æ‰§è¡Œï¼š

```bash
git checkout -b ralph/user-auth-oauth
# ç”¨ä½ åå¥½çš„ä»»ä½•å‘½åçº¦å®šåˆ›å»ºåˆ†æ”¯
# å»ºè®®ï¼šä½¿ç”¨ ralph/* å‰ç¼€å‘½åå·¥ä½œåˆ†æ”¯
```

_3. æœ‰èŒƒå›´çš„è§„åˆ’ï¼ˆåœ¨å·¥ä½œåˆ†æ”¯ä¸Šï¼‰_

```bash
./loop.sh plan-work "user authentication system with OAuth and session management"
# ä¼ å…¥è‡ªç„¶è¯­è¨€æè¿° - LLM ç”¨å®ƒæ¥é™å®šè®¡åˆ’èŒƒå›´
# åˆ›å»ºä»…åŒ…å«æ­¤å·¥ä½œä»»åŠ¡çš„èšç„¦ IMPLEMENTATION_PLAN.md
```

_4. æŒ‰è®¡åˆ’æ„å»ºï¼ˆåœ¨å·¥ä½œåˆ†æ”¯ä¸Šï¼‰_

```bash
./loop.sh
# Ralph ä»æœ‰èŒƒå›´çš„è®¡åˆ’æ„å»ºï¼ˆæ— éœ€è¿‡æ»¤ï¼‰
# ä»å·²é™å®šèŒƒå›´çš„è®¡åˆ’ä¸­é€‰æ‹©æœ€é‡è¦çš„ä»»åŠ¡
```

_5. åˆ›å»º PRï¼ˆå·¥ä½œå®Œæˆæ—¶ï¼‰_

ç”¨æˆ·æ‰§è¡Œï¼š

```bash
gh pr create --base main --head ralph/user-auth-oauth --fill
```

#### å·¥ä½œèŒƒå›´å¾ªç¯è„šæœ¬

æ‰©å±•åŸºç¡€å¢å¼ºç‰ˆå¾ªç¯è„šæœ¬ï¼Œæ·»åŠ å·¥ä½œåˆ†æ”¯æ”¯æŒå’Œæœ‰èŒƒå›´çš„è§„åˆ’ï¼š

```bash
#!/bin/bash
set -euo pipefail

# Usage:
#   ./loop.sh [plan] [max_iterations]       # Plan/build on current branch
#   ./loop.sh plan-work "work description"  # Create scoped plan on current branch
# Examples:
#   ./loop.sh                               # Build mode, unlimited
#   ./loop.sh 20                            # Build mode, max 20
#   ./loop.sh plan 5                        # Full planning, max 5
#   ./loop.sh plan-work "user auth"         # Scoped planning

# Parse arguments
MODE="build"
PROMPT_FILE="PROMPT_build.md"

if [ "$1" = "plan" ]; then
    # Full planning mode
    MODE="plan"
    PROMPT_FILE="PROMPT_plan.md"
    MAX_ITERATIONS=${2:-0}
elif [ "$1" = "plan-work" ]; then
    # Scoped planning mode
    if [ -z "$2" ]; then
        echo "Error: plan-work requires a work description"
        echo "Usage: ./loop.sh plan-work \"description of the work\""
        exit 1
    fi
    MODE="plan-work"
    WORK_DESCRIPTION="$2"
    PROMPT_FILE="PROMPT_plan_work.md"
    MAX_ITERATIONS=${3:-5}  # Default 5 for work planning
elif [[ "$1" =~ ^[0-9]+$ ]]; then
    # Build mode with max iterations
    MAX_ITERATIONS=$1
else
    # Build mode, unlimited
    MAX_ITERATIONS=0
fi

ITERATION=0
CURRENT_BRANCH=$(git branch --show-current)

# Validate branch for plan-work mode
if [ "$MODE" = "plan-work" ]; then
    if [ "$CURRENT_BRANCH" = "main" ] || [ "$CURRENT_BRANCH" = "master" ]; then
        echo "Error: plan-work should be run on a work branch, not main/master"
        echo "Create a work branch first: git checkout -b ralph/your-work"
        exit 1
    fi

    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "Mode:    plan-work"
    echo "Branch:  $CURRENT_BRANCH"
    echo "Work:    $WORK_DESCRIPTION"
    echo "Prompt:  $PROMPT_FILE"
    echo "Plan:    Will create scoped IMPLEMENTATION_PLAN.md"
    [ "$MAX_ITERATIONS" -gt 0 ] && echo "Max:     $MAX_ITERATIONS iterations"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

    # Warn about uncommitted changes to IMPLEMENTATION_PLAN.md
    if [ -f "IMPLEMENTATION_PLAN.md" ] && ! git diff --quiet IMPLEMENTATION_PLAN.md 2>/dev/null; then
        echo "Warning: IMPLEMENTATION_PLAN.md has uncommitted changes that will be overwritten"
        read -p "Continue? [y/N] " -n 1 -r
        echo
        [[ ! $REPLY =~ ^[Yy]$ ]] && exit 1
    fi

    # Export work description for PROMPT_plan_work.md
    export WORK_SCOPE="$WORK_DESCRIPTION"
else
    # Normal plan/build mode
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "Mode:   $MODE"
    echo "Branch: $CURRENT_BRANCH"
    echo "Prompt: $PROMPT_FILE"
    echo "Plan:   IMPLEMENTATION_PLAN.md"
    [ "$MAX_ITERATIONS" -gt 0 ] && echo "Max:    $MAX_ITERATIONS iterations"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
fi

# Verify prompt file exists
if [ ! -f "$PROMPT_FILE" ]; then
    echo "Error: $PROMPT_FILE not found"
    exit 1
fi

# Main loop
while true; do
    if [ "$MAX_ITERATIONS" -gt 0 ] && [ "$ITERATION" -ge "$MAX_ITERATIONS" ]; then
        echo "Reached max iterations: $MAX_ITERATIONS"

        if [ "$MODE" = "plan-work" ]; then
            echo ""
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo "Scoped plan created: $WORK_DESCRIPTION"
            echo "To build, run:"
            echo "  ./loop.sh 20"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        fi
        break
    fi

    # Run Ralph iteration with selected prompt
    # -p: Headless mode (non-interactive, reads from stdin)
    # --dangerously-skip-permissions: Auto-approve all tool calls (YOLO mode)
    # --output-format=stream-json: Structured output for logging/monitoring
    # --model opus: Primary agent uses Opus for complex reasoning (task selection, prioritization)
    #               Can use 'sonnet' for speed if plan is clear and tasks well-defined
    # --verbose: Detailed execution logging

    # For plan-work mode, substitute ${WORK_SCOPE} in prompt before piping
    if [ "$MODE" = "plan-work" ]; then
        envsubst < "$PROMPT_FILE" | claude -p \
            --dangerously-skip-permissions \
            --output-format=stream-json \
            --model opus \
            --verbose
    else
        cat "$PROMPT_FILE" | claude -p \
            --dangerously-skip-permissions \
            --output-format=stream-json \
            --model opus \
            --verbose
    fi

    # Push to current branch
    CURRENT_BRANCH=$(git branch --show-current)
    git push origin "$CURRENT_BRANCH" || {
        echo "Failed to push. Creating remote branch..."
        git push -u origin "$CURRENT_BRANCH"
    }

    ITERATION=$((ITERATION + 1))
    echo -e "\n\n======================== LOOP $ITERATION ========================\n"
done
```

#### `PROMPT_plan_work.md` æ¨¡æ¿

_æ³¨æ„ï¼š_ ä¸ `PROMPT_plan.md` ç›¸åŒï¼Œä½†å¢åŠ äº†èŒƒå›´é™å®šæŒ‡ä»¤å’Œ `WORK_SCOPE` ç¯å¢ƒå˜é‡æ›¿æ¢ï¼ˆç”±å¾ªç¯è„šæœ¬è‡ªåŠ¨å®Œæˆï¼‰ã€‚

```
0a. Study `specs/*` with up to 250 parallel Sonnet subagents to learn the application specifications.
0b. Study @IMPLEMENTATION_PLAN.md (if present) to understand the plan so far.
0c. Study `src/lib/*` with up to 250 parallel Sonnet subagents to understand shared utilities & components.
0d. For reference, the application source code is in `src/*`.

1. You are creating a SCOPED implementation plan for work: "${WORK_SCOPE}". Study @IMPLEMENTATION_PLAN.md (if present; it may be incorrect) and use up to 500 Sonnet subagents to study existing source code in `src/*` and compare it against `specs/*`. Use an Opus subagent to analyze findings, prioritize tasks, and create/update @IMPLEMENTATION_PLAN.md as a bullet point list sorted in priority of items yet to be implemented. Ultrathink. Consider searching for TODO, minimal implementations, placeholders, skipped/flaky tests, and inconsistent patterns. Study @IMPLEMENTATION_PLAN.md to determine starting point for research and keep it up to date with items considered complete/incomplete using subagents.

IMPORTANT: This is SCOPED PLANNING for "${WORK_SCOPE}" only. Create a plan containing ONLY tasks directly related to this work scope. Be conservative - if uncertain whether a task belongs to this work, exclude it. The plan can be regenerated if too narrow. Plan only. Do NOT implement anything. Do NOT assume functionality is missing; confirm with code search first. Treat `src/lib` as the project's standard library for shared utilities and components. Prefer consolidated, idiomatic implementations there over ad-hoc copies.

ULTIMATE GOAL: We want to achieve the scoped work "${WORK_SCOPE}". Consider missing elements related to this work and plan accordingly. If an element is missing, search first to confirm it doesn't exist, then if needed author the specification at specs/FILENAME.md. If you create a new element then document the plan to implement it in @IMPLEMENTATION_PLAN.md using a subagent.
```

#### ä¸æ ¸å¿ƒç†å¿µçš„å…¼å®¹æ€§

| åŸåˆ™               | æ˜¯å¦ä¿æŒï¼Ÿ | å¦‚ä½•ä¿æŒ                                                           |
| ------------------ | ---------- | ------------------------------------------------------------------ |
| å•ä½“æ“ä½œ           | âœ… æ˜¯      | Ralph ä»ä½œä¸ºåˆ†æ”¯å†…çš„å•ä¸€è¿›ç¨‹è¿è¡Œ                                   |
| æ¯æ¬¡å¾ªç¯ä¸€ä¸ªä»»åŠ¡   | âœ… æ˜¯      | ä¸å˜                                                               |
| å…¨æ–°ä¸Šä¸‹æ–‡         | âœ… æ˜¯      | ä¸å˜                                                               |
| ç¡®å®šæ€§             | âœ… æ˜¯      | åœ¨è®¡åˆ’åˆ›å»ºæ—¶é™å®šèŒƒå›´ï¼ˆç¡®å®šæ€§ï¼‰ï¼Œè€Œéè¿è¡Œæ—¶ï¼ˆæ¦‚ç‡æ€§ï¼‰               |
| ç®€æ´               | âœ… æ˜¯      | å¯é€‰å¢å¼ºï¼Œä¸»å·¥ä½œæµä»ç„¶æœ‰æ•ˆ                                         |
| è®¡åˆ’é©±åŠ¨           | âœ… æ˜¯      | æ¯ä¸ªåˆ†æ”¯ä¸€ä¸ª IMPLEMENTATION_PLAN.md                                |
| å•ä¸€çœŸå®æ¥æº       | âœ… æ˜¯      | æ¯ä¸ªåˆ†æ”¯ä¸€ä¸ªè®¡åˆ’â€”â€”æœ‰èŒƒå›´çš„è®¡åˆ’æ›¿æ¢åˆ†æ”¯ä¸Šçš„å®Œæ•´è®¡åˆ’                 |
| è®¡åˆ’å¯ä¸¢å¼ƒ         | âœ… æ˜¯      | éšæ—¶é‡æ–°ç”Ÿæˆæœ‰èŒƒå›´çš„è®¡åˆ’ï¼š`./loop.sh plan-work "work description"` |
| Markdown ä¼˜äº JSON | âœ… æ˜¯      | ä»ç„¶æ˜¯ Markdown è®¡åˆ’                                               |
| è®© Ralph åš Ralph  | âœ… æ˜¯      | Ralph ä»å·²é™å®šèŒƒå›´çš„è®¡åˆ’ä¸­é€‰æ‹©"æœ€é‡è¦çš„"â€”â€”æ— éœ€è¿‡æ»¤                 |

---

### JTBD â†’ æ•…äº‹åœ°å›¾ï¼ˆStory Mapï¼‰â†’ SLC å‘å¸ƒ

#### å…³æ³¨ä¸»é¢˜ â†’ æ´»åŠ¨ï¼ˆActivitiesï¼‰

Geoff çš„[å»ºè®®å·¥ä½œæµ](https://ghuntley.com/content/images/size/w2400/2025/07/The-ralph-Process.png)å·²ç»å°†è§„åˆ’ä¸å¾…å®Œæˆä»»åŠ¡ï¼ˆJTBDï¼‰å¯¹é½â€”â€”å°† JTBD æ‹†åˆ†ä¸ºå…³æ³¨ä¸»é¢˜ï¼Œå†è½¬åŒ–ä¸ºè§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ã€‚æˆ‘å¾ˆå–œæ¬¢è¿™ä¸ªæ–¹å¼ï¼Œæˆ‘è®¤ä¸ºæœ‰æœºä¼šé€šè¿‡å°†*å…³æ³¨ä¸»é¢˜*é‡æ–°å®šä¹‰ä¸º*æ´»åŠ¨ï¼ˆActivitiesï¼‰*æ¥è¿›ä¸€æ­¥å‘æŒ¥è¿™ç§æ–¹æ³•çš„äº§å“ä¼˜åŠ¿ã€‚

æ´»åŠ¨æ˜¯æ—…ç¨‹ä¸­çš„åŠ¨è¯ï¼ˆ"ä¸Šä¼ ç…§ç‰‡"ã€"æå–é¢œè‰²"ï¼‰ï¼Œè€Œéèƒ½åŠ›ï¼ˆ"é¢œè‰²æå–ç³»ç»Ÿ"ï¼‰ã€‚å®ƒä»¬å¤©ç„¶åœ°æŒ‰ç”¨æˆ·æ„å›¾æ¥é™å®šèŒƒå›´ã€‚

> ä¸»é¢˜ï¼š"é¢œè‰²æå–"ã€"å¸ƒå±€å¼•æ“" â†’ èƒ½åŠ›å¯¼å‘
> æ´»åŠ¨ï¼š"ä¸Šä¼ ç…§ç‰‡"ã€"æŸ¥çœ‹æå–çš„é¢œè‰²"ã€"æ’åˆ—å¸ƒå±€" â†’ æ—…ç¨‹å¯¼å‘

#### æ´»åŠ¨ â†’ ç”¨æˆ·æ—…ç¨‹

æ´»åŠ¨â€”â€”åŠå…¶ç»„æˆæ­¥éª¤â€”â€”è‡ªç„¶åœ°æ’åˆ—æˆç”¨æˆ·æµç¨‹ï¼Œåˆ›å»ºä¸€ä¸ª*æ—…ç¨‹ç»“æ„*ï¼Œä½¿å·®è·å’Œä¾èµ–å…³ç³»å¯è§ã€‚[ç”¨æˆ·æ•…äº‹åœ°å›¾ï¼ˆUser Story Mapï¼‰](https://www.nngroup.com/articles/user-story-mapping/)å°†æ´»åŠ¨ç»„ç»‡ä¸ºåˆ—ï¼ˆæ—…ç¨‹éª¨æ¶ï¼‰ï¼Œå°†èƒ½åŠ›æ·±åº¦ç»„ç»‡ä¸ºè¡Œâ€”â€”è¿™æ˜¯*å¯ä»¥*æ„å»ºçš„å®Œæ•´ç©ºé—´ï¼š

```
UPLOAD    â†’   EXTRACT    â†’   ARRANGE     â†’   SHARE

basic         auto           manual          export
bulk          palette        templates       collab
batch         AI themes      auto-layout     embed
```

#### ç”¨æˆ·æ—…ç¨‹ â†’ å‘å¸ƒåˆ‡ç‰‡ï¼ˆRelease Slicesï¼‰

é€šè¿‡åœ°å›¾çš„æ°´å¹³åˆ‡ç‰‡æˆä¸ºå€™é€‰å‘å¸ƒã€‚ä¸æ˜¯æ¯ä¸ªæ´»åŠ¨éƒ½éœ€è¦åœ¨æ¯ä¸ªå‘å¸ƒä¸­æœ‰æ–°èƒ½åŠ›â€”â€”æœ‰äº›æ ¼å­ä¿æŒç©ºç™½ï¼Œåªè¦åˆ‡ç‰‡ä»ç„¶æ˜¯è¿è´¯çš„å°±æ²¡é—®é¢˜ï¼š

```
                  UPLOAD    â†’   EXTRACT    â†’   ARRANGE     â†’   SHARE

Release 1:        basic         auto                           export
                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Release 2:                      palette        manual
                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Release 3:        batch         AI themes      templates       embed
```

#### å‘å¸ƒåˆ‡ç‰‡ â†’ SLC å‘å¸ƒ

æ•…äº‹åœ°å›¾ç»™ä½ æä¾›åˆ‡ç‰‡çš„*ç»“æ„*ã€‚Jason Cohen çš„ _[ç®€å•ã€å¯çˆ±ã€å®Œæ•´ï¼ˆSimple, Lovable, Completeï¼ŒSLCï¼‰](https://longform.asmartbear.com/slc/)_ ç»™ä½ æä¾›åˆ¤æ–­åˆ‡ç‰‡å¥½åçš„*æ ‡å‡†*ï¼š

- _ç®€å•ï¼ˆSimpleï¼‰_ â€” å¯ä»¥å¿«é€Ÿå‘å¸ƒçš„çª„èŒƒå›´ã€‚ä¸æ˜¯æ¯ä¸ªæ´»åŠ¨ï¼Œä¸æ˜¯æ¯ä¸ªæ·±åº¦ã€‚
- _å®Œæ•´ï¼ˆCompleteï¼‰_ â€” åœ¨è¯¥èŒƒå›´å†…å®Œå…¨å®Œæˆä¸€é¡¹å·¥ä½œã€‚ä¸æ˜¯ä¸€ä¸ªæ®‹ç¼ºçš„é¢„è§ˆã€‚
- _å¯çˆ±ï¼ˆLovableï¼‰_ â€” äººä»¬çœŸçš„æƒ³ç”¨å®ƒã€‚åœ¨å…¶è¾¹ç•Œå†…ä»¤äººæ„‰æ‚¦ã€‚

_ä¸ºä»€ä¹ˆé€‰ SLC è€Œé MVPï¼Ÿ_ MVP ä»¥ç‰ºç‰²å®¢æˆ·ä½“éªŒæ¥ä¼˜åŒ–å­¦ä¹ â€”â€”"æœ€å°"å¾€å¾€æ„å‘³ç€ç ´ç¢æˆ–ä»¤äººæ²®ä¸§ã€‚SLC ç¿»è½¬äº†è¿™ä¸€ç‚¹ï¼šåœ¨å¸‚åœºä¸­å­¦ä¹ çš„*åŒæ—¶*æä¾›çœŸæ­£çš„ä»·å€¼ã€‚å¦‚æœæˆåŠŸäº†ï¼Œä½ æœ‰æ›´å¤šé€‰æ‹©æƒã€‚å¦‚æœå¤±è´¥äº†ï¼Œä½ è‡³å°‘å–„å¾…äº†ç”¨æˆ·ã€‚

æ¯ä¸ªåˆ‡ç‰‡å¯ä»¥æˆä¸ºä¸€ä¸ªå…·æœ‰æ˜ç¡®ä»·å€¼å’Œèº«ä»½çš„å‘å¸ƒï¼š

```
                  UPLOAD    â†’   EXTRACT    â†’   ARRANGE     â†’   SHARE

Palette Picker:   basic         auto                           export
                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Mood Board:                     palette        manual
                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Design Studio:    batch         AI themes      templates       embed
```

- _Palette Pickerï¼ˆè‰²æ¿é€‰æ‹©å™¨ï¼‰_ â€” ä¸Šä¼ ã€æå–ã€å¯¼å‡ºã€‚ä»ç¬¬ä¸€å¤©èµ·å°±æœ‰å³æ—¶ä»·å€¼ã€‚
- _Mood Boardï¼ˆæƒ…ç»ªæ¿ï¼‰_ â€” æ·»åŠ æ’åˆ—åŠŸèƒ½ã€‚åˆ›æ„è¡¨è¾¾è¿›å…¥æ—…ç¨‹ã€‚
- _Design Studioï¼ˆè®¾è®¡å·¥ä½œå®¤ï¼‰_ â€” ä¸“ä¸šåŠŸèƒ½ï¼šæ‰¹é‡å¤„ç†ã€AI ä¸»é¢˜ã€å¯åµŒå…¥è¾“å‡ºã€‚

---

#### ä¸ Ralph çš„å®é™…æ“ä½œ

ä¸Šè¿°æ¦‚å¿µâ€”â€”æ´»åŠ¨ã€æ•…äº‹åœ°å›¾ã€SLC å‘å¸ƒâ€”â€”æ˜¯*æ€ç»´å·¥å…·*ã€‚æˆ‘ä»¬å¦‚ä½•å°†å®ƒä»¬è½¬åŒ–ä¸º Ralph çš„å·¥ä½œæµï¼Ÿ

_é»˜è®¤çš„ Ralph æ–¹æ³•ï¼š_

1. _å®šä¹‰éœ€æ±‚_ï¼šäººç±» + LLM å®šä¹‰ JTBD å…³æ³¨ä¸»é¢˜ â†’ `specs/*.md`
2. _åˆ›å»ºä»»åŠ¡è®¡åˆ’_ï¼šLLM åˆ†ææ‰€æœ‰è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ + å½“å‰ä»£ç  â†’ `IMPLEMENTATION_PLAN.md`
3. _æ„å»º_ï¼šRalph é’ˆå¯¹å®Œæ•´èŒƒå›´æ„å»º

è¿™å¯¹ä»¥èƒ½åŠ›ä¸ºä¸­å¿ƒçš„å·¥ä½œï¼ˆåŠŸèƒ½ç‰¹æ€§ã€é‡æ„ã€åŸºç¡€è®¾æ–½ï¼‰æ•ˆæœå¾ˆå¥½ã€‚ä½†å®ƒä¸ä¼šè‡ªç„¶åœ°äº§å‡ºæœ‰ä»·å€¼çš„ï¼ˆSLCï¼‰äº§å“å‘å¸ƒâ€”â€”å®ƒäº§å‡ºçš„æ˜¯"è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰æè¿°çš„ä»»ä½•ä¸œè¥¿"ã€‚

_æ´»åŠ¨ â†’ SLC å‘å¸ƒæ–¹æ³•ï¼š_

è¦è·å¾— SLC å‘å¸ƒï¼Œæˆ‘ä»¬éœ€è¦å°†æ´»åŠ¨æ‰æ ¹äºå—ä¼—ä¸Šä¸‹æ–‡ã€‚å—ä¼—å®šä¹‰äº†è°æ‹¥æœ‰ JTBDï¼Œè¿™åè¿‡æ¥å†³å®šäº†ä»€ä¹ˆæ´»åŠ¨é‡è¦ä»¥åŠ"å¯çˆ±"æ„å‘³ç€ä»€ä¹ˆã€‚

```
å—ä¼—ï¼ˆAudienceï¼Œè°ï¼‰
    â””â”€â”€ æ‹¥æœ‰ JTBDï¼ˆä¸ºä»€ä¹ˆï¼‰
            â””â”€â”€ é€šè¿‡æ´»åŠ¨ï¼ˆActivitiesï¼‰æ¥å®ç°ï¼ˆæ€ä¹ˆåšï¼‰
```

##### å·¥ä½œæµç¨‹

_I. éœ€æ±‚é˜¶æ®µï¼ˆ2 ä¸ªæ­¥éª¤ï¼‰ï¼š_

ä»åœ¨äººç±»ä¸ LLM çš„å¯¹è¯ä¸­è¿›è¡Œï¼Œç±»ä¼¼äºé»˜è®¤çš„ Ralph æ–¹æ³•ã€‚

1. _å®šä¹‰å—ä¼—åŠå…¶ JTBD_ â€” æˆ‘ä»¬ä¸ºè°æ„å»ºï¼Œä»–ä»¬æƒ³è¦ä»€ä¹ˆç»“æœï¼Ÿ
   - äººç±» + LLM è®¨è®ºå¹¶ç¡®å®šå—ä¼—åŠå…¶ JTBDï¼ˆä»–ä»¬æƒ³è¦çš„ç»“æœï¼‰
   - å¯èƒ½åŒ…å«å¤šä¸ªå…³è”çš„å—ä¼—ï¼ˆä¾‹å¦‚"è®¾è®¡å¸ˆ"åˆ›å»ºï¼Œ"å®¢æˆ·"å®¡é˜…ï¼‰
   - ç”Ÿæˆ `AUDIENCE_JTBD.md`

2. _å®šä¹‰æ´»åŠ¨_ â€” ç”¨æˆ·åšä»€ä¹ˆæ¥å®Œæˆä»–ä»¬çš„ JTBDï¼Ÿ
   - ä»¥ `AUDIENCE_JTBD.md` ä¸ºå‚è€ƒ
   - å¯¹æ¯ä¸ª JTBDï¼Œè¯†åˆ«å®Œæˆå®ƒæ‰€éœ€çš„æ´»åŠ¨
   - å¯¹æ¯ä¸ªæ´»åŠ¨ï¼Œç¡®å®šï¼š
     - èƒ½åŠ›æ·±åº¦ï¼ˆåŸºç¡€ â†’ å¢å¼ºï¼‰â€”â€”ç²¾ç»†åº¦çš„å±‚çº§
     - æ¯ä¸ªæ·±åº¦çš„æœŸæœ›ç»“æœâ€”â€”æˆåŠŸæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ
   - ç”Ÿæˆ `specs/*.md`ï¼ˆæ¯ä¸ªæ´»åŠ¨ä¸€ä»½ï¼‰

   æ´»åŠ¨ä¸­çš„ç¦»æ•£æ­¥éª¤æ˜¯éšå¼çš„ï¼ŒLLM å¯ä»¥åœ¨è§„åˆ’æœŸé—´æ¨æ–­ã€‚

_II. è§„åˆ’é˜¶æ®µï¼š_

åœ¨ Ralph å¾ªç¯ä¸­ä½¿ç”¨*æ›´æ–°çš„*è§„åˆ’æç¤ºè¯è¿›è¡Œã€‚

- LLM åˆ†æï¼š
  - `AUDIENCE_JTBD.md`ï¼ˆè°ï¼ŒæœŸæœ›ç»“æœï¼‰
  - `specs/*`ï¼ˆå¯ä»¥æ„å»ºä»€ä¹ˆï¼‰
  - å½“å‰ä»£ç çŠ¶æ€ï¼ˆå·²æœ‰ä»€ä¹ˆï¼‰
- LLM ç¡®å®šä¸‹ä¸€ä¸ª SLC åˆ‡ç‰‡ï¼ˆå“ªäº›æ´»åŠ¨ã€åœ¨ä»€ä¹ˆèƒ½åŠ›æ·±åº¦ï¼‰å¹¶ä¸ºè¯¥åˆ‡ç‰‡è§„åˆ’ä»»åŠ¡
- LLM ç”Ÿæˆ `IMPLEMENTATION_PLAN.md`
- *äººç±»éªŒè¯*æ„å»ºå‰çš„è®¡åˆ’ï¼š
  - èŒƒå›´æ˜¯å¦ä»£è¡¨ä¸€ä¸ªè¿è´¯çš„ SLC å‘å¸ƒï¼Ÿ
  - æ˜¯å¦åŒ…å«äº†æ­£ç¡®æ·±åº¦çš„æ­£ç¡®æ´»åŠ¨ï¼Ÿ
  - å¦‚æœä¸å¯¹ â†’ é‡æ–°è¿è¡Œè§„åˆ’å¾ªç¯ä»¥é‡æ–°ç”Ÿæˆè®¡åˆ’ï¼Œå¯é€‰æ‹©æ›´æ–°è¾“å…¥æˆ–è§„åˆ’æç¤ºè¯
  - å¦‚æœæ­£ç¡® â†’ è¿›å…¥æ„å»ºé˜¶æ®µ

_III. æ„å»ºé˜¶æ®µï¼š_

åœ¨ Ralph å¾ªç¯ä¸­ä½¿ç”¨æ ‡å‡†æ„å»ºæç¤ºè¯è¿›è¡Œã€‚

##### æ›´æ–°çš„è§„åˆ’æç¤ºè¯

`PROMPT_plan.md` çš„å˜ä½“ï¼Œæ·»åŠ äº†å—ä¼—ä¸Šä¸‹æ–‡å’Œ SLC å¯¼å‘çš„åˆ‡ç‰‡æ¨èã€‚

_æ³¨æ„ï¼š_

- ä¸é»˜è®¤æ¨¡æ¿ä¸åŒï¼Œè¿™é‡Œæ²¡æœ‰ `[project-specific goal]` å ä½ç¬¦â€”â€”ç›®æ ‡æ˜¯éšå«çš„ï¼šä¸ºå—ä¼—æ¨èæœ€æœ‰ä»·å€¼çš„ä¸‹ä¸€ä¸ªå‘å¸ƒã€‚
- å½“å‰å­ä»£ç†åç§°å‡è®¾ä½¿ç”¨ Claudeã€‚

```
0a. Study @AUDIENCE_JTBD.md to understand who we're building for and their Jobs to Be Done.
0b. Study `specs/*` with up to 250 parallel Sonnet subagents to learn JTBD activities.
0c. Study @IMPLEMENTATION_PLAN.md (if present) to understand the plan so far.
0d. Study `src/lib/*` with up to 250 parallel Sonnet subagents to understand shared utilities & components.
0e. For reference, the application source code is in `src/*`.

1. Sequence the activities in `specs/*` into a user journey map for the audience in @AUDIENCE_JTBD.md. Consider how activities flow into each other and what dependencies exist.

2. Determine the next SLC release. Use up to 500 Sonnet subagents to compare `src/*` against `specs/*`. Use an Opus subagent to analyze findings. Ultrathink. Given what's already implemented recommend which activities (at what capability depths) form the most valuable next release. Prefer thin horizontal slices - the narrowest scope that still delivers real value. A good slice is Simple (narrow, achievable), Lovable (people want to use it), and Complete (fully accomplishes a meaningful job, not a broken preview).

3. Use an Opus subagent (ultrathink) to analyze and synthesize the findings, prioritize tasks, and create/update @IMPLEMENTATION_PLAN.md as a bullet point list sorted in priority of items yet to be implemented for the recommended SLC release. Begin plan with a summary of the recommended SLC release (what's included and why), then list prioritized tasks for that scope. Consider TODOs, placeholders, minimal implementations, skipped tests - but scoped to the release. Note discoveries outside scope as future work.

IMPORTANT: Plan only. Do NOT implement anything. Do NOT assume functionality is missing; confirm with code search first. Treat `src/lib` as the project's standard library for shared utilities and components. Prefer consolidated, idiomatic implementations there over ad-hoc copies.

ULTIMATE GOAL: We want to achieve the most valuable next release for the audience in @AUDIENCE_JTBD.md. Consider missing elements and plan accordingly. If an element is missing, search first to confirm it doesn't exist, then if needed author the specification at specs/FILENAME.md. If you create a new element then document the plan to implement it in @IMPLEMENTATION_PLAN.md using a subagent.
```

##### è¯´æ˜

_ä¸ºä»€ä¹ˆ `AUDIENCE_JTBD.md` ä½œä¸ºå•ç‹¬çš„åˆ¶å“ï¼š_

- å•ä¸€çœŸå®æ¥æºâ€”â€”é˜²æ­¢è·¨è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰çš„æ¼‚ç§»
- å¯ç”¨å…¨å±€æ¨ç†ï¼š"è¿™ä¸ªå—ä¼—æœ€éœ€è¦ä»€ä¹ˆï¼Ÿ"
- JTBD ä¸å—ä¼—ä¸€åŒè®°å½•ï¼ˆ"ä¸ºä»€ä¹ˆ"ä¸"è°"åœ¨ä¸€èµ·ï¼‰
- è¢«å¼•ç”¨ä¸¤æ¬¡ï¼šåœ¨è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰åˆ›å»ºå’Œ SLC è§„åˆ’æ—¶
- è®©æ´»åŠ¨è§„æ ¼è¯´æ˜ï¼ˆSpecï¼‰ä¸“æ³¨äº"åšä»€ä¹ˆ"ï¼Œè€Œä¸æ˜¯é‡å¤"ä¸ºè°åš"

_åŸºæ•°å…³ç³»ï¼š_

- ä¸€ä¸ªå—ä¼— â†’ å¤šä¸ª JTBDï¼ˆ"è®¾è®¡å¸ˆ"æœ‰"æ•æ‰ç©ºé—´"ã€"æ¢ç´¢æ¦‚å¿µ"ã€"å‘å®¢æˆ·å±•ç¤º"ï¼‰
- ä¸€ä¸ª JTBD â†’ å¤šä¸ªæ´»åŠ¨ï¼ˆ"æ•æ‰ç©ºé—´"åŒ…æ‹¬ä¸Šä¼ ã€æµ‹é‡ã€æˆ¿é—´æ£€æµ‹ï¼‰
- ä¸€ä¸ªæ´»åŠ¨ â†’ å¯ä»¥æœåŠ¡å¤šä¸ª JTBDï¼ˆ"ä¸Šä¼ ç…§ç‰‡"åŒæ—¶æœåŠ¡äº"æ•æ‰"å’Œ"æ”¶é›†çµæ„Ÿ"ï¼‰

# Spec Review Processing Summary — v13

Processed: 2026-01-30

---

## Issue Summary

| ID | Title | Decision | Changes Applied | Guide Rules |
|----|-------|----------|-----------------|-------------|
| 1 | Get Plan Status Missing AuthZ Context (IDOR Risk) | Already Resolved | — | G8 |
| 2 | Queue Failure Recovery Contradicts Confirm Plan Idempotency | Accepted | Updated Confirm Plan inbound contract; updated state model transition label; clarified invariants | G10 |
| 3 | Metadata Overlay Field Name Drift vs Central Contract | Already Resolved | — | G9 |
| 4 | Central Contract Type System (`time` Undefined) | Accepted | Added Primitive Type Definitions section to data-definitions.md | Checklist (type sufficiency) |

---

## Detailed Changes

### Issue 2: Queue Failure Recovery Contradicts Confirm Plan Idempotency

**Changes Applied:**
1. **Confirm Plan inbound contract** — Rewrote Processing and Output to explicitly cover:
   - On enqueue success: persist status → `confirmed`, return ExecutionPlan
   - On enqueue failure: status remains `pending_confirmation`, return ServiceError (`service_unavailable`)
   - Added 403 (user mismatch) and 503 (enqueue failure) to error cases
2. **State model diagram** — Changed transition label from "user confirms" to "user confirms + enqueue succeeds"
3. **Invariants section** — Added explicit invariant that `pending_confirmation` → `confirmed` requires successful enqueue; failure allows re-attempt

### Issue 4: Central Contract Type System (`time` Undefined)

**Changes Applied:**
1. **data-definitions.md** — Added new "Primitive Type Definitions" section with canonical table defining:
   - All 7 primitive types (string, number, boolean, date, datetime, time, enum)
   - Representation and format/constraints for each
   - `time` explicitly defined as `HH:MM (24-hour), local venue time unless otherwise specified`

---

## Already Resolved (No Action Needed)

- **Issue 1**: Get Plan Status now includes `user_id` + auth token + ownership precondition + auth error cases (401/403/404)
- **Issue 3**: Metadata key standardized to `iq_enabled` matching central contract

---

## Declined Suggestions

None.
